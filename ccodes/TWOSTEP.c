#include <stdio.h>
#include <stdlib.h>
#include <math.h>

double mx[] = {-0.183820755, -0.074717025, 0.112956476, 0.286248604, 0.439293845, 0.574218653, 0.684270358, 0.728362037, 0.750316721, 0.733376354, 0.659959282, 0.569130188, 0.438236183, 0.28744087, 0.110993636, -0.077494407, -0.270180388, -0.457666021, -0.633343689, -0.786659487, -0.913356677, -1.013029644, -1.082236035, -1.103289483, -1.085873257, -1.024226705, -0.918630638, -0.792103996, -0.635663246, -0.450534168, -0.275946187, -0.079506554, 0.113255681, 0.282526653, 0.432619322, 0.56448264, 0.647454749, 0.71830507, 0.741058974, 0.710085811, 0.647465362, 0.5531995, 0.429511645, 0.286201226, 0.100979402, -0.080829175, -0.266088679, -0.459495599, -0.620466133, -0.784310134, -0.887372687, -0.998675897, -1.062943289, -1.087844994, -1.070842144, -1.006627277, -0.907660548, -0.786749869, -0.621966001, -0.449430282, -0.271272075, -0.085794773, 0.095798824, 0.256631764, 0.407625854, 0.53495903, 0.612691672, 0.682298204, 0.690408371, 0.671830514, 0.624003399, 0.528955797, 0.404301683, 0.262973791, 0.086040696, -0.084064982, -0.263776799, -0.443568968, -0.610835081, -0.764106956, -0.86610004, -0.968817273, -1.020493114, -1.034737976, -1.012720557, -0.960962966, -0.867431639, -0.747985921, -0.606775106, -0.444571118, -0.26652986, -0.092246777, 0.077096082, 0.238776975, 0.360822636, 0.480394443, 0.555810222, 0.614951836, 0.627299259, 0.608138333, 0.564078358, 0.474911939, 0.359299739, 0.221551223, 0.073460314, -0.094769168, -0.257984242, -0.41550103, -0.566652718, -0.6946099, -0.815563972, -0.901702563, -0.947055803, -0.967013133, -0.949663436, -0.892751898, -0.827080613, -0.71545472, -0.574656679, -0.426943294, -0.259462606, -0.099777745, 0.045088993, 0.186029942, 0.308658634, 0.394756708, 0.474115145, 0.517324188, 0.530331148, 0.516776186, 0.475898334, 0.393481753, 0.307765527, 0.171454495, 0.038724097, -0.095948394, -0.254228236, -0.389895207, -0.531604744, -0.650988128, -0.749688965, -0.816116148, -0.856588747, -0.883957816, -0.856549421, -0.823621793, -0.740490456, -0.644109353, -0.531868001, -0.379457559, -0.236367853, -0.113753276, 0.014252565, 0.11887111, 0.222392494, 0.301477787, 0.383545227, 0.40816512, 0.415946444, 0.400267173, 0.374926777, 0.317618427, 0.234594191, 0.138382378, 0.003341129, -0.115194591, -0.230458231, -0.363024429, -0.463700421, -0.5717841, -0.663278242, -0.708210273, -0.742564953, -0.770615098, -0.755165951, -0.718320409, -0.649586125, -0.574252415, -0.474831543, -0.349413625, -0.232690129, -0.122622386, -0.025889216, 0.05658631, 0.136801657, 0.195310663, 0.25117443, 0.281085801, 0.29557752, 0.266336518, 0.254171536, 0.203543273, 0.145623581, 0.053535852, -0.035035549, -0.127099869, -0.22444802, -0.319572633, -0.413752163, -0.476648617, -0.548077832, -0.596758682, -0.624997583, -0.632995396, -0.62605096, -0.59793395, -0.54759217, -0.476160299, -0.411772473, -0.320283641, -0.219709627, -0.130215766, -0.068846983, -0.018285353, 0.031869573, 0.08670732, 0.113511864, 0.134776179, 0.139301446, 0.131777006, 0.107666671, 0.081838721, 0.042702356, -0.013771367, -0.06869102, -0.139590638, -0.205574113, -0.262540663, -0.323947635, -0.387578134, -0.429125915, -0.452230052, -0.47417504, -0.486086384, -0.477304066, -0.457647582, -0.426318425, -0.380298113, -0.335223224, -0.264703532, -0.201320322, -0.155070099, -0.12576745, -0.086763329, -0.054143874, -0.048407637, -0.028167515, -0.019930937, -0.014609605, -0.014589134, -0.024794417, -0.040122699, -0.066184609, -0.092489708, -0.123543993, -0.155615073, -0.194584389, -0.222938311, -0.241135351, -0.281312332, -0.288137038, -0.31578639, -0.322317799, -0.333465377, -0.345579966, -0.326236687, -0.310773346, -0.283274591, -0.255977148, -0.218931371, -0.192497981, -0.169770307, -0.161473119, -0.162990448, -0.151502441, -0.170314689, -0.177978704, -0.17265042, -0.169674894, -0.167535144, -0.177288846, -0.162899899, -0.179266609, -0.165053263, -0.155691262, -0.176243781, -0.168135176, -0.173678843, -0.172584806, -0.17737581, -0.171331385, -0.173936788, -0.176886457, -0.171330177, -0.1660758, -0.169913557, -0.176392913, -0.172552625, -0.174051911, -0.177962368, -0.163648868, -0.189861663, -0.212925973, -0.249436662, -0.270134786, -0.304958502, -0.33057993, -0.327896424, -0.327903675, -0.336067343, -0.319956241, -0.291622531, -0.28655115, -0.260579645, -0.231084681, -0.184468011, -0.155538332, -0.113373524, -0.085853347, -0.060806474, -0.042693998, -0.028544982, -0.007973579, -0.010874221, -0.010057289, -0.022353809, -0.044955645, -0.065121916, -0.091208376, -0.129807475, -0.165469899, -0.207497295, -0.263065751, -0.338466503, -0.383827094, -0.424969108, -0.456700114, -0.487970976, -0.494071698, -0.479917269, -0.460293387, -0.427766404, -0.381969349, -0.335500361, -0.270922472, -0.204395094, -0.145632751, -0.066440554, -0.006220768, 0.039784241, 0.074914442, 0.116925137, 0.136487505, 0.143943516, 0.132240968, 0.116010422, 0.082037324, 0.048172486, -0.004522266, -0.083447164, -0.145292431, -0.225684726, -0.313328526, -0.413262482, -0.476323726, -0.534230319, -0.593347013, -0.61257867, -0.635068752, -0.626680276, -0.592231042, -0.549531681, -0.468419125, -0.39799628, -0.310721467, -0.221470303, -0.121932042, -0.027391145, 0.063930363, 0.135545023, 0.197576861, 0.257206868, 0.26910819, 0.298037158, 0.281608992, 0.236359857, 0.201030616, 0.144326359, 0.062695463, -0.032926735, -0.120458591, -0.22191674, -0.348222129, -0.471960936, -0.568162728, -0.645592325, -0.719820071, -0.747846923, -0.77719252, -0.749553589, -0.707945066, -0.650389923, -0.576471261, -0.480838271, -0.34690417, -0.220315362, -0.116596005, -0.002884026, 0.123729515, 0.221439881, 0.307409506, 0.375738659, 0.408129166, 0.420662823, 0.403028717, 0.359245901, 0.299819671, 0.227453372, 0.125971164, 0.00189763, -0.107848332, -0.244233306, -0.385363652, -0.516886602, -0.645788422, -0.751797569, -0.820077732, -0.859398898, -0.872833155, -0.853347037, -0.82558244, -0.745205501, -0.62646852, -0.525867649, -0.393812987, -0.234328239, -0.093292779, 0.05132184, 0.183000633, 0.299380744, 0.387107207, 0.470821844, 0.501407179, 0.525698672, 0.515489093, 0.473624922, 0.400872223, 0.289170711, 0.183045957, 0.05070316, -0.101950312, -0.254198807, -0.413337871, -0.575755388, -0.697495405, -0.809173097, -0.895276707, -0.957743496, -0.969833289, -0.952717819, -0.898946257, -0.824258137, -0.695453386, -0.576575465, -0.418418257, -0.250984231, -0.083102245, 0.086982274, 0.221654092, 0.361105005, 0.471473117, 0.562810828, 0.613735416, 0.645166397, 0.607632662, 0.562636028, 0.472779797, 0.351357497, 0.234169951, 0.082646458, -0.095247375, -0.257444182, -0.43107755, -0.605239602, -0.756490296, -0.875364782, -0.963089227, -1.022122291, -1.030446223, -1.022049787, -0.952527733, -0.878896211, -0.749088522, -0.601214014, -0.436537588, -0.257114127, -0.081466813, 0.099882978, 0.259921895, 0.413904094, 0.537134194, 0.618520684, 0.683772978, 0.691361552, 0.6765138, 0.622057528, 0.534880735, 0.417668923, 0.255299277, 0.099117836, -0.075697716, -0.257004156, -0.45053323, -0.629757183, -0.776072779, -0.902219952, -0.998116529, -1.061395058, -1.064412609, -1.058300275, -0.999200961, -0.908771058, -0.778421667, -0.624166737, -0.45083168, -0.270356351, -0.087101984, 0.112051911, 0.277825423, 0.430076964, 0.574048616, 0.655331951, 0.722258019, 0.738624094, 0.707074297, 0.663165457, 0.561831334, 0.439008628, 0.291407754, 0.104612011, -0.084825023, -0.263871766, -0.447251596, -0.643066825, -0.786744754, -0.918088259, -1.01378927, -1.076510736, -1.092128416, -1.077049031, -1.014734233, -0.91880236, -0.78454633, -0.635599985, -0.45577385, -0.276741449, -0.080967639, 0.114832091, 0.28780362, 0.43794014, 0.573691855, 0.671535285, 0.726619559, 0.745280342, 0.729110223, 0.679408994, 0.573566793, 0.450785751, 0.292859523, 0.110265936, -0.074528276, -0.179131375
};

double my[] = {-0.070347325, -0.082136983, -0.078585953, -0.080718769, -0.098595076, -0.09520232, -0.113944931, -0.105526505, -0.10746533, -0.110198579, -0.104423848, -0.098840318, -0.105059709, -0.083461567, -0.090477864, -0.069751465, -0.064191554, -0.056226835, -0.059296052, -0.047390377, -0.041372923, -0.051774874, -0.049603711, -0.027947542, -0.049065287, -0.047008295, -0.048067949, -0.060344782, -0.053061771, -0.064211587, -0.069973366, -0.064659689, -0.051618859, -0.024875853, -0.011968837, 0.005708527, 0.011044286, 0.018024779, 0.026467955, 0.022528695, 0.017083697, 0.011029758, -0.016038758, -0.020495431, -0.039614288, -0.072955158, -0.078558553, -0.101224515, -0.117584774, -0.141947206, -0.147853864, -0.164422798, -0.164721313, -0.169136854, -0.170440462, -0.166665483, -0.153581168, -0.153785167, -0.128444526, -0.09913812, -0.089721246, -0.041325964, -0.005541442, 0.040226613, 0.086672804, 0.106609748, 0.138464589, 0.157619399, 0.153197464, 0.141716843, 0.136985342, 0.121728265, 0.08091317, 0.045411089, 4.90E-05, -0.045314354, -0.094517189, -0.153321921, -0.193203979, -0.226686919, -0.265431419, -0.288444975, -0.3023729, -0.293122542, -0.311819455, -0.286600693, -0.254096399, -0.232146812, -0.188057411, -0.148158188, -0.086635766, -0.037835361, 0.043192875, 0.107092673, 0.163935297, 0.218066003, 0.252831361, 0.267116205, 0.287303004, 0.271557813, 0.265284327, 0.208737339, 0.161527146, 0.098970638, 0.043634887, -0.041042172, -0.099046858, -0.179817204, -0.243861283, -0.306313987, -0.353145398, -0.382389212, -0.414527875, -0.44194306, -0.417890195, -0.393647934, -0.348546009, -0.30773812, -0.247667564, -0.193724838, -0.108363068, -0.034501705, 0.077019073, 0.151586197, 0.224734093, 0.303212532, 0.354484939, 0.373220333, 0.383448859, 0.38210939, 0.358737079, 0.301703803, 0.236440088, 0.16254256, 0.06765435, -0.026514913, -0.116906007, -0.213561835, -0.298798097, -0.389430322, -0.448465039, -0.495774952, -0.528475659, -0.539010831, -0.529662871, -0.497790611, -0.454149109, -0.380201875, -0.302599995, -0.22103575, -0.121144227, -0.020076515, 0.101412965, 0.213487972, 0.301685291, 0.386034042, 0.44348585, 0.470807732, 0.484159223, 0.480853496, 0.440339748, 0.381903739, 0.287740746, 0.204700575, 0.104714182, -0.011821594, -0.132217911, -0.24684797, -0.357592719, -0.449021708, -0.540990108, -0.586231211, -0.624223278, -0.645670002, -0.632081392, -0.583544518, -0.527291122, -0.447743918, -0.362173849, -0.258709432, -0.136638864, -0.007681872, 0.130058306, 0.253515838, 0.365318909, 0.458713075, 0.509565908, 0.556030346, 0.561655156, 0.55617343, 0.51434603, 0.453393845, 0.352045325, 0.246794101, 0.13298595, -0.012580679, -0.138564882, -0.272555744, -0.385391409, -0.498843064, -0.595106557, -0.660957318, -0.703408816, -0.714018034, -0.706277698, -0.673705258, -0.593572402, -0.499735936, -0.393175326, -0.265738109, -0.139791494, -0.001924094, 0.138353733, 0.287612903, 0.403732032, 0.499311103, 0.582778786, 0.61037815, 0.641685177, 0.61332122, 0.574194654, 0.485722785, 0.393865096, 0.285618708, 0.143219523, -0.001548189, -0.152895193, -0.294609593, -0.426256647, -0.555069449, -0.642970652, -0.715708698, -0.767736011, -0.784897231, -0.766262768, -0.722770006, -0.650832075, -0.5386774, -0.424984057, -0.292081094, -0.136060565, 0.000372518, 0.157684019, 0.30214837, 0.413310119, 0.516985326, 0.608395046, 0.650169566, 0.66311186, 0.6525833, 0.605615432, 0.526324384, 0.425470994, 0.295875353, 0.161095492, 0.003268438, -0.157786926, -0.298810876, -0.441257111, -0.567546229, -0.67746023, -0.760563404, -0.80140038, -0.82041762, -0.800889802, -0.764224301, -0.687249301, -0.565426689, -0.445369371, -0.303304604, -0.149136715, 0.012150131, 0.15779501, 0.29843673, 0.434958392, 0.550544963, 0.620030452, 0.687143372, 0.683574301, 0.670749942, 0.628037171, 0.548016554, 0.433860938, 0.301048929, 0.158615289, -0.004677847, -0.156888078, -0.318557769, -0.458224974, -0.595349565, -0.697508416, -0.771470173, -0.817672699, -0.824932933, -0.805971545, -0.759153954, -0.679027801, -0.581697149, -0.457770967, -0.310146461, -0.152410736, 0.004516514, 0.159957802, 0.306504863, 0.437733149, 0.537462546, 0.613437794, 0.655446464, 0.677046555, 0.675897043, 0.611706924, 0.539805395, 0.43328636, 0.311063356, 0.14736027, 0.004515835, -0.159593467, -0.306204472, -0.460277912, -0.585533894, -0.674639598, -0.766811967, -0.816055995, -0.83145524, -0.807827128, -0.754040001, -0.696524227, -0.58228563, -0.454052076, -0.312532075, -0.154297764, -0.002204058, 0.148147571, 0.283973589, 0.417534001, 0.519367021, 0.593407096, 0.634844141, 0.656588876, 0.639682459, 0.59079871, 0.498920229, 0.418704965, 0.294405094, 0.150975654, 0.003409671, -0.144389554, -0.304572339, -0.429594239, -0.553099964, -0.653256849, -0.740404715, -0.787614246, -0.803020194, -0.773643051, -0.732311655, -0.666306824, -0.55653566, -0.437898082, -0.296175578, -0.144487877, -0.005738054, 0.124791338, 0.263893009, 0.372772203, 0.486462245, 0.556016673, 0.592883842, 0.612914814, 0.590321351, 0.553429918, 0.475575845, 0.368042814, 0.259405912, 0.142606174, -0.006179326, -0.148562401, -0.286093966, -0.406569314, -0.530725603, -0.623680462, -0.688863657, -0.736028867, -0.747948279, -0.732310332, -0.686300164, -0.630995929, -0.530085861, -0.41400669, -0.281013013, -0.143173919, -0.012774926, 0.11830502, 0.230026574, 0.327074553, 0.415752688, 0.480279724, 0.525769829, 0.535256514, 0.514655147, 0.475795801, 0.430791035, 0.328057292, 0.235997227, 0.107658235, -0.007304381, -0.130747435, -0.266557239, -0.388730305, -0.47493463, -0.563877745, -0.62922977, -0.666541303, -0.66668803, -0.671356796, -0.616083627, -0.563046935, -0.480190893, -0.371610783, -0.261760901, -0.148495646, -0.026907352, 0.099690817, 0.178378897, 0.272734948, 0.34115021, 0.395530784, 0.425523872, 0.443170222, 0.42622561, 0.395979079, 0.337737331, 0.279698448, 0.185696236, 0.090736234, -0.030817359, -0.127254526, -0.232352556, -0.327205885, -0.420658642, -0.487846571, -0.546487065, -0.572616981, -0.589437967, -0.586942123, -0.549078126, -0.498579948, -0.425240442, -0.331319843, -0.225761483, -0.130325403, -0.029767325, 0.057601288, 0.12269323, 0.192267582, 0.256942551, 0.29282104, 0.327674761, 0.322948231, 0.32383946, 0.301603594, 0.25293161, 0.195085916, 0.136188733, 0.058124841, -0.044076518, -0.114819962, -0.193196823, -0.279654914, -0.340839661, -0.406878218, -0.449229286, -0.470456976, -0.483558278, -0.471098154, -0.437357897, -0.408893377, -0.348530658, -0.277989192, -0.211342233, -0.120780141, -0.048642962, 0.010867844, 0.075443637, 0.121685512, 0.155057571, 0.190079369, 0.205889805, 0.216015597, 0.21745527, 0.18758017, 0.168763541, 0.111105876, 0.063999763, 0.026669018, -0.045748757, -0.109936709, -0.158423364, -0.223345117, -0.264044353, -0.308208482, -0.33572028, -0.369942405, -0.372618241, -0.350825708, -0.338998754, -0.309916591, -0.27063146, -0.224453848, -0.157849784, -0.103545219, -0.048270135, -0.02833071, 0.01795745, 0.04027357, 0.060589063, 0.074429528, 0.086395023, 0.083181713, 0.086620135, 0.080806869, 0.051353886, 0.040148512, 0.007350736, -0.026452366, -0.048258274, -0.092515056, -0.123986233, -0.154856368, -0.186319102, -0.202487675, -0.227815582, -0.232859433, -0.243478488, -0.230325067, -0.233007374, -0.206679216, -0.180340969, -0.15836117, -0.125339908, -0.090162014, -0.082476714, -0.06489906, -0.058283497, -0.045833493, -0.041377966, -0.045692073, -0.051036462, -0.040549175, -0.046214912, -0.040352502, -0.0595493, -0.056751025, -0.047553958, -0.070289401, -0.066312907, -0.060189713, -0.072700357, -0.090586114, -0.092788355, -0.097902037, -0.108533258, -0.11601697, -0.112923614, -0.107590398, -0.096913055, -0.091460133, -0.097919641, -0.095620439, -0.078462183, -0.070767081, -0.069047438
};

double mz[] = {1.32023337, 1.31473725, 1.278237985, 1.183602742, 1.052832999, 0.87194675, 0.660661011, 0.44040068, 0.187582035, -0.056933137, -0.303625557, -0.524173953, -0.721764143, -0.863628938, -0.963619444, -1.033134344, -1.040485453, -0.995169107, -0.913079912, -0.780814882, -0.602066128, -0.401793384, -0.164194393, 0.085665267, 0.327394867, 0.572920806, 0.779813924, 0.978978348, 1.138360741, 1.238495433, 1.309463065, 1.317656312, 1.273027849, 1.185334662, 1.044078329, 0.869949633, 0.637543511, 0.422457224, 0.176668255, -0.06370826, -0.300460521, -0.519682584, -0.711053322, -0.86189001, -0.979028156, -1.029526522, -1.03649246, -1.003504697, -0.906655128, -0.772437404, -0.582849083, -0.383897504, -0.156521763, 0.079677949, 0.33002037, 0.570621468, 0.785170818, 0.979710702, 1.13787507, 1.249884366, 1.304818113, 1.321272761, 1.272040683, 1.172180037, 1.040700894, 0.858784285, 0.649498448, 0.418866781, 0.157771244, -0.070775418, -0.315857568, -0.523154728, -0.726551374, -0.865681956, -0.983585686, -1.035303362, -1.034786694, -1.007549282, -0.90350275, -0.772516554, -0.589260129, -0.380705099, -0.139777532, 0.096655595, 0.348585275, 0.586159211, 0.802168172, 0.981657323, 1.145187893, 1.264647241, 1.311259489, 1.310623938, 1.255959819, 1.166909199, 1.031117322, 0.847203833, 0.638838049, 0.407682613, 0.151687147, -0.10050073, -0.324408433, -0.537292939, -0.717025218, -0.87669793, -0.969402016, -1.035048523, -1.033699684, -0.999417021, -0.900953184, -0.761600962, -0.583345031, -0.372559585, -0.126918691, 0.103524673, 0.366623983, 0.591912308, 0.808803006, 0.99575185, 1.140397372, 1.24780674, 1.29755553, 1.321613389, 1.265327112, 1.172199401, 1.020855967, 0.835276967, 0.629446667, 0.39434331, 0.14832571, -0.091349893, -0.337528852, -0.540277293, -0.737740767, -0.881653928, -0.995995513, -1.029543884, -1.041493105, -0.98679655, -0.903514087, -0.749096122, -0.569507026, -0.366615441, -0.121217623, 0.125002523, 0.354582697, 0.606318492, 0.830442976, 1.000065346, 1.156417033, 1.243650981, 1.300968461, 1.316515073, 1.260235331, 1.160964167, 1.013585034, 0.839398313, 0.612504331, 0.379034461, 0.139395611, -0.103816328, -0.339978451, -0.558977173, -0.744618511, -0.890921234, -1.001243411, -1.040545892, -1.037063841, -0.999791869, -0.886553852, -0.739471012, -0.5736392, -0.353253951, -0.123834419, 0.137002784, 0.373525663, 0.614956156, 0.826567682, 1.005352206, 1.16117658, 1.256095193, 1.313503114, 1.304989391, 1.258015845, 1.14763178, 1.0052783, 0.820158342, 0.608544485, 0.373298617, 0.126734456, -0.108376648, -0.356342005, -0.567226584, -0.761644482, -0.895608554, -1.001874137, -1.044597074, -1.046180205, -0.980296106, -0.889943314, -0.730077932, -0.554214072, -0.336266968, -0.086900584, 0.140123689, 0.391747087, 0.623031852, 0.836222663, 1.010104097, 1.163610342, 1.260774305, 1.314677421, 1.296762191, 1.259151296, 1.142556626, 0.990636091, 0.811588904, 0.594192693, 0.355348421, 0.111797408, -0.126786362, -0.37267925, -0.573290855, -0.755354564, -0.898282239, -0.999576802, -1.03764997, -1.039675356, -0.987240914, -0.881168729, -0.72949417, -0.552787789, -0.337439661, -0.090015866, 0.137091675, 0.395885467, 0.637118627, 0.849927369, 1.020304283, 1.171454766, 1.262671668, 1.316647495, 1.309020945, 1.253036266, 1.150284284, 0.980948049, 0.801607655, 0.588334769, 0.354472927, 0.103450139, -0.137607937, -0.374777793, -0.591534323, -0.761397695, -0.90085037, -0.999548274, -1.049591271, -1.026913462, -0.977871839, -0.880978461, -0.721491041, -0.54466144, -0.31792119, -0.07951468, 0.16439328, 0.415930787, 0.646639653, 0.8583385, 1.025100679, 1.176124479, 1.266030628, 1.310142845, 1.291500457, 1.25323239, 1.138170591, 0.987970042, 0.802352488, 0.579710277, 0.342743441, 0.085727844, -0.14729533, -0.39436135, -0.592484567, -0.769496307, -0.90156522, -0.999230001, -1.036266719, -1.035916124, -0.994227657, -0.872168836, -0.71978273, -0.52470644, -0.317825588, -0.076451164, 0.179598739, 0.426642618, 0.646452493, 0.864271555, 1.037837208, 1.174412143, 1.266994485, 1.319618093, 1.31164897, 1.252836835, 1.145970465, 0.981724095, 0.799799228, 0.568679, 0.334892489, 0.083436139, -0.157342657, -0.390727602, -0.597967934, -0.772106911, -0.898833963, -1.005129861, -1.046937632, -1.04556298, -0.981407617, -0.865149082, -0.713007362, -0.517713087, -0.303093517, -0.068068347, 0.188167548, 0.431866744, 0.652759411, 0.874003987, 1.034837787, 1.173897867, 1.271592471, 1.318080916, 1.305183553, 1.237692049, 1.132910911, 0.978588573, 0.792275498, 0.563081001, 0.326742199, 0.079841703, -0.166371782, -0.392216066, -0.608737131, -0.773223285, -0.915741995, -1.007052459, -1.050756756, -1.036277358, -0.975657167, -0.867049548, -0.698172889, -0.510764805, -0.300734548, -0.042526303, 0.190409802, 0.438736868, 0.665994029, 0.870527237, 1.050426832, 1.187309775, 1.266599998, 1.317234808, 1.304335554, 1.23159671, 1.116261169, 0.964333802, 0.773870236, 0.555186343, 0.31986231, 0.076796957, -0.177040399, -0.399512356, -0.614355814, -0.789059102, -0.919749874, -1.014107473, -1.047974744, -1.029596248, -0.968775531, -0.854178603, -0.701227738, -0.504837012, -0.277708318, -0.050557476, 0.193926304, 0.441268381, 0.650154191, 0.876438332, 1.065005134, 1.182836014, 1.262721801, 1.320602534, 1.296547671, 1.23689161, 1.118058374, 0.963713503, 0.784059643, 0.548952002, 0.32224507, 0.069081331, -0.185103597, -0.407881041, -0.599240075, -0.781520778, -0.923499431, -1.015161875, -1.049513964, -1.031978271, -0.95152902, -0.86176516, -0.701205866, -0.513315026, -0.289609553, -0.050833305, 0.202618611, 0.442164304, 0.675527899, 0.872740725, 1.056097129, 1.185149361, 1.27308956, 1.321206808, 1.300368451, 1.235172521, 1.125317714, 0.964622665, 0.777360209, 0.556251221, 0.313005745, 0.059420302, -0.180877265, -0.407908429, -0.624195974, -0.790617031, -0.922441514, -1.016927078, -1.049754393, -1.042890224, -0.973767083, -0.842569734, -0.702240172, -0.518648697, -0.280368359, -0.049331503, 0.202292434, 0.452324361, 0.68299036, 0.886358969, 1.057772348, 1.17917053, 1.285501234, 1.310109783, 1.297695811, 1.241377874, 1.128242232, 0.954700127, 0.782197638, 0.551709315, 0.322107774, 0.075424483, -0.188810915, -0.404799324, -0.619322063, -0.789305426, -0.922189772, -1.005889694, -1.04644202, -1.028513793, -0.975774232, -0.859784427, -0.702737457, -0.50268366, -0.287803073, -0.04378085, 0.202434949, 0.441441861, 0.675742527, 0.879382655, 1.051237093, 1.190845777, 1.280319042, 1.317712243, 1.305906576, 1.232259895, 1.125595919, 0.970875264, 0.779778503, 0.552811719, 0.311330504, 0.060154598, -0.176959676, -0.409050071, -0.615269179, -0.78987762, -0.920557393, -1.005317081, -1.050971498, -1.02745522, -0.962247926, -0.854033129, -0.695559395, -0.501541774, -0.296620637, -0.047937124, 0.199886171, 0.44295193, 0.681738266, 0.880934545, 1.059989522, 1.194434834, 1.273764456, 1.315613751, 1.289546442, 1.237790667, 1.135258697, 0.975359934, 0.779696027, 0.558298843, 0.321972684, 0.068548987, -0.17375821, -0.407388648, -0.607686382, -0.789981671, -0.910281064, -1.009161855, -1.050099968, -1.027791892, -0.96047554, -0.864643277, -0.700325252, -0.518793516, -0.294022723, -0.047575062, 0.199005418, 0.441375131, 0.667644503, 0.881845987, 1.052934647, 1.187639672, 1.280541788, 1.31102446, 1.291973079, 1.229709749, 1.132781637, 0.978790729, 0.798176656, 0.572605656, 0.327399091, 0.074521067, -0.15753347, -0.391165488, -0.60095379, -0.779382844, -0.915691156, -1.0102691, -1.042736937, -1.029791412, -0.987853483, -0.861337704, -0.721695793, -0.51766944, -0.294677661, -0.06149939, 0.190200411, 0.428377382, 0.662022211, 0.882291044, 1.04418445, 1.177482487, 1.275212567, 1.316187825, -1.044457556
};

#define N 9
#define N1 3

typedef struct 
{
    double r1;
    double r2;
    double r3;
} raizes_t;

void inverter_matriz9x9(double matriz[N][N], double inversa[N][N]) {
    // Inicializando a matriz identidade na matriz inversa
    for (int i = 0; i < N; i++) {
        for (int j = 0; j < N; j++) {
            if (i == j) {
                inversa[i][j] = 1;
            } else {
                inversa[i][j] = 0;
            }
        }
    }

    // Aplicando o método de Gauss-Jordan
    for (int i = 0; i < N; i++)
    {
        double pivot = matriz[i][i];
        for (int j = 0; j < N; j++)
        {
            matriz[i][j] /= pivot;
            inversa[i][j] /= pivot;
        }

        for (int k = 0; k < N; k++)
        {
            if (k != i)
            {
                double fator = matriz[k][i];
                for (int j = 0; j < N; j++)
                {
                    matriz[k][j] -= fator * matriz[i][j];
                    inversa[k][j] -= fator * inversa[i][j];
                }
            }
        }
    }
}

void inverter_matriz3x3(double matriz[N1][N1], double inversa[N1][N1]) {
    // Inicializando a matriz identidade na matriz inversa
    for (int i = 0; i < N1; i++) {
        for (int j = 0; j < N1; j++) {
            if (i == j) {
                inversa[i][j] = 1;
            } else {
                inversa[i][j] = 0;
            }
        }
    }

    // Aplicando o método de Gauss-Jordan
    for (int i = 0; i < N1; i++)
    {
        double pivot = matriz[i][i];
        for (int j = 0; j < N1; j++)
        {
            matriz[i][j] /= pivot;
            inversa[i][j] /= pivot;
        }

        for (int k = 0; k < N1; k++)
        {
            if (k != i)
            {
                double fator = matriz[k][i];
                for (int j = 0; j < N1; j++)
                {
                    matriz[k][j] -= fator * matriz[i][j];
                    inversa[k][j] -= fator * inversa[i][j];
                }
            }
        }
    }
}

void resolver_cubica(double a, double b, double c, double d, raizes_t *raizes)
{
    // Passo 1: Reduzindo para a forma t^3 + pt + q = 0
    double p = (3 * a * c - b * b) / (3 * a * a);
    double q = (2 * b * b * b - 9 * a * b * c + 27 * a * a * d) / (27 * a * a * a);

    // Passo 2: Calculando o discriminante
    double delta = pow(q / 2, 2) + pow(p / 3, 3);

    // Passo 3: Encontrar as raízes com base no valor de delta
    if (delta == 0) {
        // Três raízes reais (pelo menos duas iguais)
        double u = cbrt(-q / 2);
        raizes->r1 = 2 * u - b / (3 * a);
        raizes->r2 = -u - b / (3 * a);
        raizes->r3 = raizes->r2;
    } else {
        // Três raízes reais diferentes
        double r = sqrt(-p / 3);
        double theta = acos(-q / (2 * pow(r, 3)));
        raizes->r3 = 2 * r * cos(theta / 3) - b / (3 * a);
        raizes->r1 = 2 * r * cos((theta + 2 * 3.14159265358979323846) / 3) - b / (3 * a);
        raizes->r2 = 2 * r * cos((theta + 4 * 3.14159265358979323846) / 3) - b / (3 * a);
    }
}

void autovetor(double A[N1][N1], double lambda, double x[N1])
{
    double A_lambda[3][3], v[3] = {1, 1, 1}, A_lambda_inv[3][3], norma = 0;
    for(int i=0; i < 3; i++)
    {
        for(int j=0; j < 3; j++)
        {
            if(i == j)
            {
                A_lambda[i][j] = A[i][j] - lambda;
            }
            else
            {
                A_lambda[i][j] = A[i][j];
            }
        }
    }
    inverter_matriz3x3(A_lambda, A_lambda_inv);
    for(int i=0; i < 3; i++)
    {
        x[i] = 0;
        for(int j=0; j < 3; j++)
        {
            x[i] += A_lambda_inv[i][j]*v[j];
        }
    }

    for(int i=0; i < 3; i++)
    {
        norma += x[i]*x[i];
    }
    norma = sqrt(norma);
    for(int i=0; i < 3; i++)
    {
        x[i] /= norma;
    }
}


void SVD_dec(double A[N1][N1], double U[N1][N1], double S[N1][N1])
{
    double a, b, c, d;
    raizes_t raizes;
    double AU1[3], AU2[3], AU3[3]; 

    a = -1;
    b = A[0][0] + A[1][1] + A[2][2];
    c = -A[0][0]*A[1][1] - A[0][0]*A[2][2] - A[1][1]*A[2][2] + A[0][1]*A[1][0] + A[0][2]*A[2][0] + A[0][2]*A[2][0];
    d = A[0][0]*A[1][1]*A[2][2] + A[0][1]*A[1][2]*A[2][0] + A[0][1]*A[1][0]*A[2][1] - A[0][1]*A[1][0]*A[2][2] - A[1][2]*A[2][1]*A[0][0] - A[0][2]*A[2][0]*A[1][1];

    resolver_cubica(a, b, c, d, &raizes);
    S[0][0] = raizes.r1;
    S[0][1] = 0;
    S[0][2] = 0;
    S[1][1] = raizes.r2;
    S[1][0] = 0;
    S[1][2] = 0;
    S[2][2] = raizes.r3;
    S[2][0] = 0;
    S[2][1] = 0;

    autovetor(A, raizes.r1, AU1);
    autovetor(A, raizes.r2, AU2);
    autovetor(A, raizes.r3, AU3);
    

    U[0][0] = AU1[0];
    U[0][1] = AU1[1];
    U[0][2] = AU1[2];
    U[1][0] = AU2[0];
    U[1][1] = AU2[1];
    U[1][2] = AU2[2];
    U[2][0] = AU3[0];
    U[2][1] = AU3[1];
    U[2][2] = AU3[2];
}

void main()
{
    int tam1 = (sizeof(mx)/sizeof(double));
    #define tam tam1
    
    int passo_max = 200;
    int passo = 0, loop = 1;
    double stop = pow(10, -24);
    double H[tam], Sigma_noise[3][tam];
    double z_k[tam], mu_k[tam], sigma_k[tam], L_k[9][tam], sigma_bar = 0;
    double z_bar = 0, mu_bar = 0, L_bar[9] = {0, 0, 0, 0, 0, 0, 0, 0, 0};
    double z_tilde[tam], mu_tilde[tam], L_tilde[9][tam];
    double F_tt[9][9], F_tt_copy[9][9], P_tt[9][9];
    double theta[9] = {0, 0, 0, 0, 0, 0, 0, 0, 0}, theta1[9] = {0, 0, 0, 0, 0, 0, 0, 0, 0};
    double TS_erro = 0, c[3], E[3][3], E_inv[3][3], tmp[3][3], dJdThetap_tilde[9], dbsqdtheta_p[9], dJdThetap_bar[9], dJdThetap_bar_scalar = 0, dJdTheta[9], F_tt_bar[9][9], F_tt_bar_copy[9][9], F_tt_bar_vet[9], F_tt_bar_inv[9][9], theta_np1[9], E_inv_c[3] = {0, 0, 0};
    double ABC[9] = {0, 0, 0, 0, 0, 0, 0, 0, 0};
    double U[3][3], S[3][3], W[3][3], D[3][3], D_copy[3][3], h[3], D_inv[3][3];


    for(int i=0; i < tam; i++)
    {
        H[i] = 1;
        Sigma_noise[0][i] = 0.006*0.006;
        Sigma_noise[1][i] = 0.006*0.006;
        Sigma_noise[2][i] = 0.006*0.006;
        z_k[i] = pow(sqrt(mx[i]*mx[i] + my[i]*my[i] + mz[i]*mz[i]), 2) - H[i]*H[i];
        mu_k[i] = -(Sigma_noise[0][i] + Sigma_noise[1][i] + Sigma_noise[2][i]);
        sigma_k[i] = 4*(mx[i]*mx[i]*Sigma_noise[0][i] + my[i]*my[i]*Sigma_noise[1][i] + mz[i]*mz[i]*Sigma_noise[2][i]) + 2*(Sigma_noise[0][i]*Sigma_noise[0][i] + Sigma_noise[1][i]*Sigma_noise[1][0] + Sigma_noise[2][i]*Sigma_noise[2][i]);
        sigma_bar += 1/sigma_k[i];
        L_k[0][i] = 2*mx[i];
        L_k[1][i] = 2*my[i];
        L_k[2][i] = 2*mz[i];
        L_k[3][i] = -(mx[i]*mx[i]);
        L_k[4][i] = -(my[i]*my[i]);
        L_k[5][i] = -(mz[i]*mz[i]);
        L_k[6][i] = -2*mx[i]*my[i];
        L_k[7][i] = -2*mx[i]*mz[i];
        L_k[8][i] = -2*my[i]*mz[i];
    }
    sigma_bar = 1/sigma_bar;
    
    for(int i=0; i < tam; i++)
    {
        z_bar += z_k[i]*sigma_bar/sigma_k[i];
        mu_bar += mu_k[i]*sigma_bar/sigma_k[i];
        for(int j=0; j < 9; j++)
        {
            L_bar[j] += L_k[j][i]*sigma_bar/sigma_k[i];
        }
    }

    for(int i=0; i < tam; i++)
    {
        z_tilde[i] = z_k[i] - z_bar;
        mu_tilde[i] = mu_k[i] - mu_bar;
        for(int j=0; j < 9; j++)
        {
            L_tilde[j][i] = L_k[j][i] - L_bar[j];
        }
    }

    for(int i=0; i < 9; i++)
    {
        for(int j=0; j < 9; j++)
        {
            F_tt[i][j] = 0;
            F_tt_copy[i][j] = 0;
            P_tt[i][j] = 0;
        }
    }

    for(int i=0; i < tam; i++)
    {
        for(int j=0; j < 9; j++)
        {
            for(int k=0; k < 9; k++)
            {
                F_tt[j][k] += (L_tilde[j][i]*L_tilde[k][i])/sigma_k[i];
                F_tt_copy[j][k] = F_tt[j][k];
            }
        }
    }

    inverter_matriz9x9(F_tt_copy, P_tt);

    for(int i=0; i < 9; i++)
    {
        for(int j=0; j < tam; j++)
        {
            theta1[i] += ((z_tilde[j]-mu_tilde[j])*L_tilde[i][j])/sigma_k[j];
        }
    }
    for(int i=0; i < 9; i++)
    {
        for(int j=0; j < 9; j++)
        {
            theta[j] += P_tt[i][j]*theta1[i];
        }
    }

    
    for(int i=0; i < 9; i++)
    {
        for(int j=0; j < tam; j++)
        {
            ABC[i] -= ((z_tilde[j]-mu_tilde[j])*L_tilde[i][j])/sigma_k[j];
        }
    }

    while(loop == 1)
    {
        if(passo != 0)
        {
            for(int i=0; i < 9; i++)
            {
                theta[i] = theta_np1[i];
            }
        }
        
        c[0] = theta[0];
        c[1] = theta[1];
        c[2] = theta[2];

        E[0][0] = theta[3] + 1;
        E[0][1] = theta[6];
        E[0][2] = theta[7];
        E[1][0] = theta[6];
        E[1][1] = theta[4] + 1;
        E[1][2] = theta[8];
        E[2][0] = theta[7];
        E[2][1] = theta[8];
        E[2][2] = theta[5] + 1;

        inverter_matriz3x3(E, E_inv);

        //Cálculo do vetor E_inv * c
        for(int i=0; i < 3; i++)
        {
            E_inv_c[i] = (E_inv[0][i] + E_inv[1][i] + E_inv[2][i])*c[i];
        }

        //Cálculo da matriz tmp = E_inv * c * E_inv * c
        for(int i=0; i < 3; i++)
        {
            for(int j=0; j < 3; j++)
            {
                tmp[i][j] = E_inv_c[i]*E_inv_c[j];
            }
        }

        //Cálculo do vetor dJdThetap_tilde
        for(int i=0; i < 9; i++)
        {
            dJdThetap_tilde[i] = ABC[i];
            for(int j=0; j < 9; j++)
            {
                dJdThetap_tilde[i] += F_tt[i][j]*theta[j];
            }
        }

        //Cálculo do vetor dbsqdtheta_p
        dbsqdtheta_p[0] = 2*E_inv_c[0];
        dbsqdtheta_p[1] = 2*E_inv_c[1];
        dbsqdtheta_p[2] = 2*E_inv_c[2];
        dbsqdtheta_p[3] = -tmp[0][0];
        dbsqdtheta_p[4] = -tmp[1][1];
        dbsqdtheta_p[5] = -tmp[2][2];
        dbsqdtheta_p[6] = -2*tmp[0][1];
        dbsqdtheta_p[7] = -2*tmp[0][2];
        dbsqdtheta_p[8] = -2*tmp[1][2];

        //Cálculo do vetor dJdThetap_bar
        dJdThetap_bar_scalar = 0;
        for(int i=0; i < 9; i++)
        {
            dJdThetap_bar_scalar -= L_bar[i]*theta[i];
        }
        for(int i=0; i < 3; i++)
        {
            dJdThetap_bar_scalar += c[i]*E_inv_c[i];
        }
        dJdThetap_bar_scalar = dJdThetap_bar_scalar - mu_bar + z_bar;
        dJdThetap_bar_scalar = -dJdThetap_bar_scalar/sigma_bar;
        for(int i=0; i < 9; i++)
        {
            dJdThetap_bar[i] = dJdThetap_bar_scalar*(L_bar[i] - dbsqdtheta_p[i]);
        }

        //Cálculo do vetor dJdTheta
        for(int i=0; i < 9; i++)
        {
            dJdTheta[i] = dJdThetap_tilde[i] + dJdThetap_bar[i];
        }

        //Cálculo da matriz F_tt_bar
        for(int i=0; i < 9; i++)
        {
            F_tt_bar_vet[i] = (L_bar[i] - dbsqdtheta_p[i]);
        }
        for(int i=0; i < 9; i++)
        {
            for(int j=0; j < 9; j++)
            {
                F_tt_bar[i][j] = (F_tt_bar_vet[i]*F_tt_bar_vet[j])/sigma_bar + F_tt[i][j];
                F_tt_bar_copy[i][j] = F_tt_bar[i][j];
            }
        }

        //Cálculo do vetor theta_np1
        inverter_matriz9x9(F_tt_bar_copy, F_tt_bar_inv);
        for(int i=0; i < 9; i++)
        {
            theta_np1[i] = theta[i];
            for(int j=0; j < 9; j++)
            {
                theta_np1[i] -= F_tt_bar_inv[i][j]*dJdTheta[j];
            }
        }

        //Cálculo do erro
        TS_erro = 0;
        for(int i=0; i < 9; i++)
        {
            for(int j=0; j < 9; j++)
            {
                TS_erro += (theta_np1[i] - theta[i])*F_tt_bar[i][j]*(theta_np1[j] - theta[j]);
            }
        }


        if(passo > passo_max || TS_erro < stop)
        {
            loop = 0;
        }
        passo += 1;
    }
    c[0] = theta[0];
    c[1] = theta[1];
    c[2] = theta[2];

    E[0][0] = theta[3];
    E[0][1] = theta[6];
    E[0][2] = theta[7];
    E[1][0] = theta[6];
    E[1][1] = theta[4];
    E[1][2] = theta[8];
    E[2][0] = theta[7];
    E[2][1] = theta[8];
    E[2][2] = theta[5];

    // Segundo passo, encontrando os parâmetros
    SVD_dec(E, U, S);
    W[0][0] = -1 + sqrt(S[0][0] + 1);
    W[0][1] = 0;
    W[0][2] = 0;
    W[1][0] = 0;
    W[1][1] = -1 + sqrt(S[1][1] + 1);
    W[1][2] = 0;
    W[2][0] = 0;
    W[2][1] = 0;
    W[2][2] = -1 + sqrt(S[2][2] + 1);

    for(int i=0; i < 3; i++)
    {
        for(int j=0; j < 3; j++)
        {
            D[i][j] = 0;
            for(int k=0; k < 3; k++)
            {
                D[i][j] += U[i][k]*W[k][k]*U[j][k];
            }
            if(i == j)
            {
                D_copy[i][j] = D[i][j] + 1;
            }
            else
            {
                D_copy[i][j] = D[i][j];
            }
        }
    }

    inverter_matriz3x3(D_copy, D_inv);

    for(int i=0; i < 3; i++)
    {
        h[i] = 0;
        for(int j=0; j < 3; j++)
        {
            h[i] += D_inv[i][j]*c[j];
        }
    }
    
    printf("Os parâmetros são: \n%f\n%f\n%f\n", h[0], h[1], h[2]);
    printf("\n");
    printf("A matriz D é:\n");
    for(int i=0; i < 3; i++)
    {
        for(int j=0; j < 3; j++)
        {
            printf("%f ", D[i][j]);
        }
        printf("\n");
    }

    printf("\n");
    printf("Convergiu em %d passos\n", passo);
}