#include <stdio.h>
#include <stdlib.h>
#include <math.h>

float mx[] = {-0.171478193126762,-0.1275138758132,-0.0259084742578213,0.0588964198486789,0.14386048129443,0.194397518980639,0.256222350139156,0.27727488806319,0.294101176908937,0.287444025623022,0.243820076392455,0.20596981232351,0.129081272361153,0.0538339550271932,-0.0204054474147798,-0.112664971684468,-0.22003229663394,-0.313596484741358,-0.401453285768075,-0.478177307396079,-0.555031317799632,-0.588534238124173,-0.623751706208954,-0.646671055094951,-0.632440314896622,-0.604270372154784,-0.545336096943916,-0.47705425009945,-0.398633717481425,-0.328677234090696,-0.222968867955541,-0.119506533746705,-0.0312258803367713,0.0510705669098109,0.127082822672756,0.193957048953264,0.24505963744544,0.277493510829049,0.28229796921285,0.277567193908857,0.24340571209029,0.189907818366911,0.132234207994982,0.0596745361403034,-0.0332896090101297,-0.132813634738003,-0.231207704913031,-0.298352448698683,-0.402040569740893,-0.476849137730291,-0.542801039768415,-0.588806732451387,-0.620053489651766,-0.624340327059395,-0.61561525048261,-0.586124388191458,-0.547654474224877,-0.476951559057866,-0.399272813163252,-0.309769171217633,-0.217678766514569,-0.126594795558497,-0.0499436834947799,0.0513175557881495,0.121187318071018,0.170147345685337,0.22496925315915,0.250672743332783,0.250525036013082,0.257504669948268,0.223846987312425,0.177435711295725,0.117744169068254,0.0406628248846088,-0.0466606112560509,-0.122837048917058,-0.216762531959944,-0.301414394594622,-0.388019009386412,-0.459271728283156,-0.522379169897074,-0.5713430429202,-0.584074217326601,-0.598073572983577,-0.602566475911839,-0.567254369177176,-0.520239831591038,-0.460282711540242,-0.391584540678518,-0.301105315623329,-0.218421654363638,-0.133590999935911,-0.0454792127685112,0.0274817295315791,0.0956476121703543,0.152363867158897,0.207237939338563,0.219148080835226,0.219342280898904,0.224918239030269,0.202419594876095,0.14672981041128,0.0862465316758497,0.0338032022298833,-0.0407712716932165,-0.136127168991112,-0.214228939825383,-0.290134443597583,-0.38604120802597,-0.442335870771477,-0.496755196375696,-0.532852566595771,-0.562780304150671,-0.570002549552184,-0.565292920058981,-0.543896893706554,-0.487138250690865,-0.445285833675388,-0.375307627545797,-0.299154410257247,-0.222974759258545,-0.141926023381495,-0.078284149022615,-0.00101089776935614,0.0690206588484883,0.115528882650757,0.147736029229727,0.186348346514498,0.176076939692786,0.178630590077251,0.137125891108954,0.112372395985644,0.0623655721308356,0.00404129696564858,-0.0552626186476954,-0.141144079733553,-0.209859045289095,-0.272150333794586,-0.342002732318119,-0.407856819731375,-0.458875531850633,-0.500720963863446,-0.519825049502982,-0.527880005548626,-0.523505890814406,-0.496427698966735,-0.462266773277713,-0.407902152626737,-0.351918209640895,-0.282287735371028,-0.217946820955341,-0.137345127553092,-0.0785056026520941,-0.0177363688044109,0.0236215540015238,0.0554532904241529,0.0867031826493093,0.112495037549011,0.124504472883115,0.123434312648133,0.0963854543482505,0.069744209403901,0.023866565774417,-0.0259273689812199,-0.0859727059626158,-0.149068932143578,-0.214399048333512,-0.270651094223223,-0.323203670541439,-0.37370481153792,-0.407093639631911,-0.435620712842037,-0.46251041642033,-0.467753367802927,-0.457954006818051,-0.437928593509089,-0.414315122343204,-0.353937967939933,-0.309627476017165,-0.264190262364973,-0.197091215050317,-0.144260776826997,-0.105950388578867,-0.0606512276997387,-0.0119938681227548,0.0101282652820229,0.0285183914305517,0.0530697724304267,0.0568937036239171,0.0638646818634376,0.0434690372121915,0.0244260833086182,-0.0182307507727694,-0.0564840324966976,-0.0965679228267799,-0.148525199331024,-0.199258863237672,-0.236734315720006,-0.281327688694841,-0.32173707352436,-0.358541571391415,-0.381402815724341,-0.397738860036642,-0.398402775939123,-0.399524840507521,-0.376686913544342,-0.359549194759978,-0.321758682151436,-0.296732135121899,-0.220395007662574,-0.196835176755953,-0.159983710109811,-0.120369045001068,-0.0861335811228514,-0.0708326362594349,-0.0391333464090591,-0.0219769376650493,-0.00450483716353162,-0.0139036138667964,-0.0223300325303609,-0.0306606280786622,-0.0430785858736456,-0.0622387145525466,-0.0873254754287638,-0.119825018509489,-0.163893705787218,-0.191289587274868,-0.227227200334162,-0.24592638290065,-0.279584275275745,-0.291603324994876,-0.327569650426605,-0.328737656390832,-0.326366640159816,-0.316791274326421,-0.321423787038035,-0.300253141948005,-0.28062270625345,-0.270625881367556,-0.220915574996573,-0.193222814882585,-0.17567173007381,-0.144080619822237,-0.133405861080914,-0.121745565075002,-0.112881661572935,-0.103158070685849,-0.0906742089141292,-0.0950478345922132,-0.0945139066964146,-0.0884112708066759,-0.102897508888056,-0.1189405632871,-0.132659019209151,-0.149774934342743,-0.169289425564079,-0.181660001952634,-0.195376438038971,-0.208164041117944,-0.222146005185738,-0.233999507744537,-0.242728970510831,-0.257203712284366,-0.252332792433247,-0.261922794740987,-0.23798479956434,-0.241121836484657,-0.226756337478827,-0.216929883204217,-0.204420645159615,-0.182965623699814,-0.180279429641482,-0.17628617766075,-0.161841845934859,-0.171984145300938,-0.165289155420755,-0.169013145176293,-0.173606857477512,-0.171511949258912,-0.172419975717967,-0.171575483168451,-0.175816909239511,-0.181081335967701,-0.162853087831571,-0.169506352660225,-0.170392860756046,-0.168299088771979,-0.172830115396238,-0.163990428903976,-0.173675500693757,-0.173541968559166,-0.175461774808192,-0.175632133865611,-0.178613971807382,-0.173473622136816,-0.168558397539563,-0.182346350792377,-0.172528508487636,-0.172957639035927,-0.17485103677518,-0.17005982563262,-0.17494109594661,-0.199698918060294,-0.218849494634022,-0.224503795826231,-0.239818789908811,-0.242656419155559,-0.244872995923977,-0.249521919235862,-0.249831423881855,-0.250938779897416,-0.23746336110864,-0.221196758209944,-0.213655659753271,-0.189613113220534,-0.174095255863057,-0.156661020961536,-0.148190345235672,-0.120054694910858,-0.118860775507662,-0.106246355820633,-0.101299499643664,-0.0971716619523574,-0.0875838130115264,-0.0873604889883011,-0.0886080618888391,-0.102718326452425,-0.124323031656122,-0.145053378349109,-0.147627014991575,-0.167155496233446,-0.182882862469899,-0.21768776051802,-0.258815469484957,-0.281955811059086,-0.293469226262988,-0.310429748794569,-0.322716142345799,-0.332307644925913,-0.32914266051378,-0.312981582340363,-0.304357045384131,-0.278088446734722,-0.254641137178122,-0.21976701183655,-0.189612218079792,-0.161249580295175,-0.130977231042616,-0.0863839522572708,-0.0646717155890507,-0.0461628534041777,-0.0267820171557568,-0.0206612379609182,-0.00672396491651668,-0.0238107147133248,-0.0210960770584215,-0.0429345256921781,-0.0643341665663585,-0.088412739180722,-0.122610766121171,-0.164621269916565,-0.193222628703168,-0.241497761235734,-0.28353950941982,-0.324609119079866,-0.353794760435162,-0.382426767731181,-0.398220554052177,-0.41058637675958,-0.40347503448457,-0.387481617810689,-0.370069999451158,-0.327381649310627,-0.28887242852396,-0.24746847847819,-0.189578004023505,-0.159437309076184,-0.107806971098441,-0.0581128774174438,-0.0194403004270152,0.0171822323757793,0.0462699651512898,0.054965572683248,0.0589140610807316,0.0454232135975808,0.0369162635665964,0.0182337444227504,-0.0176082721449938,-0.0695715320881146,-0.11107516624883,-0.146934790790707,-0.198702551938376,-0.269128680670689,-0.316944964100732,-0.368587245194175,-0.402919547628521,-0.436768703681039,-0.46083613006516,-0.470994763335681,-0.461607696195652,-0.445135313635808,-0.407688658888653,-0.379849948433277,-0.319406538555891,-0.260876640100227,-0.196949774901072,-0.147342840647144,-0.0756416900121945,-0.0302218740581718,0.030845598025011,0.0701250664306633,0.0949030613866521,0.130550530894237,0.129292894970402,0.117833881740115,0.103637200739715,0.0615327943581761,0.0316210955966644,-0.0205817289659032,-0.0855254163571214,-0.138206620675978,-0.212822330622521,-0.286469718369402,-0.35982440611715,-0.41092818964618,-0.467790598846485,-0.49196333502419,-0.521692986473632,-0.513443463702669,-0.509533569077526,-0.490573737325738,-0.451300052603812,-0.408310880407674,-0.335013515067126,-0.281927633984366,-0.220937457713101,-0.141956356624188,-0.0720346017386634,-0.000987507582059108,0.0582863011613716,0.115819680424254,0.136947031427344,0.178081129580036,0.176097955128827,0.164722168039225,0.145296747054932,0.10618139173641,0.0583803380269449,0.0079885611728855,-0.0630394147101676,-0.140496247200735,-0.222708244127837,-0.292079587836382,-0.381118243259631,-0.436599023769583,-0.49213112964695,-0.540237770738919,-0.560201137931844,-0.580279772484714,-0.566763707757521,-0.531182164941308,-0.497041487964656,-0.445435469055872,-0.362651910520171,-0.296915241521405,-0.213177248686421,-0.138879856452882,-0.0437436754391501,0.0281125825657953,0.0980203533558419,0.150694017754862,0.189166386953117,0.21925258771852,0.236603406951392,0.212218837479807,0.203709645968643,0.151585648410805,0.0997530208257071,0.0276893425945183,-0.0584913708698499,-0.130115961818314,-0.217877231366867,-0.30593530151448,-0.391892435546968,-0.455445127255904,-0.514911549155965,-0.564417201310736,-0.588195599495766,-0.600531851640958,-0.600661521891426,-0.575568880601143,-0.527830416246791,-0.461159975048574,-0.386194111786558,-0.308996841257476,-0.213516298712218,-0.125019138455193,-0.048626762012867,0.0457919093713223,0.126623753289578,0.174712782337742,0.220159904338465,0.248223870675955,0.262743522602413,0.255268057413028,0.217181718119284,0.171919237204406,0.118492913448581,0.0478749430777883,-0.0424735941022769,-0.121329691784331,-0.212138640800328,-0.30540986742703,-0.401987110511979,-0.469986719442328,-0.547773277419421,-0.589236071085741,-0.612107783954368,-0.623266901674275,-0.613785403990742,-0.583377626697822,-0.532077601876552,-0.467987225778125,-0.3977083084022,-0.321365681080042,-0.218475618488922,-0.120111668886925,-0.036532263048218,0.0602735876229825,0.127690861165814,0.194993944549301,0.250503258848866,0.271958207309514,0.27260059702368,0.265833682513531,0.247156839583661,0.187593240395008,0.125738916699518,0.0507249821635712,-0.0322460042036661,-0.122563272770217,-0.220803847009141,-0.31280835442511,-0.399249829572444,-0.480789213606537,-0.555283514421786,-0.589873861013086,-0.621649681549666,-0.63408120645078,-0.628081110386158,-0.588348703354978,-0.546477166082013,-0.48602235685756,-0.406272848389274,-0.307354672611919,-0.221227180960266,-0.126249905881077,-0.0285383902483719,0.0613650957758454,0.144981162783368,0.209682644836694,0.252180274394655,0.284977487130738,0.279728744158315,0.281057160186807,0.249222771436979,0.209000550455747,0.132439534770718,0.0563862808908034,-0.0305768896291921,-0.128141792531641,-0.166235233420957};

float my[] = {-0.0730971496487251,-0.0794025698583776,-0.0807727975434774,-0.0860509591537292,-0.0841732770221935,-0.0901643623843323,-0.101320719638724,-0.0995569853620552,-0.0968539037425055,-0.0919634398865326,-0.0835423500933051,-0.0884678727535926,-0.0850849325109895,-0.0781436547322742,-0.0832024943818784,-0.062026188185341,-0.0766940812320712,-0.0637705288079572,-0.0824360574757388,-0.0694262331667361,-0.0672865509466304,-0.0634756664619691,-0.0526748980212969,-0.063828521699909,-0.0588191878576269,-0.0480528947228134,-0.0542652216270611,-0.0670611641403259,-0.0680812569173016,-0.0610248513553182,-0.0710911745949423,-0.0744954647101522,-0.0609505230309938,-0.0460789048020849,-0.0431375602497626,-0.0390719171180961,-0.0274385284055605,-0.0198636603855109,-0.0197752336880148,-0.0347015511662361,-0.0252366029066967,-0.0303125837383147,-0.0532056791577388,-0.0421174721759917,-0.0464018120201189,-0.0701019708481801,-0.0805972846492874,-0.0918781124661616,-0.0984557432653667,-0.120376083960751,-0.119998458180854,-0.126563491429255,-0.120755543955625,-0.127445237048159,-0.126728074607555,-0.10898370561184,-0.113375961754257,-0.104013978938082,-0.0980509910775097,-0.0933505461899376,-0.0797326497729605,-0.0629426457915377,-0.0475283930406317,-0.00530036673877422,-0.00196459836561417,0.0195874170305682,0.0234394294542447,0.0405533280923354,0.0457675577002544,0.0463500571114358,0.0335379352150606,0.00787261457533201,0.00668015583989596,-0.0249648668715773,-0.0323611225493269,-0.0700399073628135,-0.0853741877484622,-0.117571608242314,-0.139324037717906,-0.150953347682743,-0.163026938621929,-0.187107765321426,-0.18093747757831,-0.199875285871997,-0.194273165063204,-0.182896625013409,-0.174380411936639,-0.159472789890414,-0.127530248383266,-0.113654316907524,-0.076036618241388,-0.0604826223921255,-0.0219989498565317,0.0115792875612083,0.0394779051990733,0.0667754439605112,0.0962760125103011,0.0956555283543601,0.0976368547430672,0.104211592601091,0.0883524165906408,0.0772426405989098,0.0523714322064839,0.0230253841757854,-0.0122258289243667,-0.0600909502302723,-0.0963575307191349,-0.126927254690241,-0.164256550453558,-0.195646502228794,-0.215244555888288,-0.235935080872699,-0.254753160198499,-0.248655954536697,-0.238893806015182,-0.233776659171821,-0.215765932408667,-0.200458344457422,-0.165708832818998,-0.129229642623647,-0.0940605180931275,-0.0342906441701184,-0.0114649049971189,0.0408387382510511,0.0882493081688469,0.114692673101424,0.138682902935332,0.156494997570216,0.163789012635783,0.138415530116878,0.137030741251716,0.109833719339344,0.0863765275254635,0.0324954223252236,0.00192079308731115,-0.0445506902188518,-0.104416864212503,-0.154157467963198,-0.187797949762461,-0.225351299004291,-0.258762886573577,-0.28867908504399,-0.295142511470891,-0.309101126967963,-0.298780237908274,-0.273150395504413,-0.263042048017493,-0.227656420571325,-0.189542554082736,-0.150734274719038,-0.0994808533477728,-0.0405590143165806,0.0153177221316714,0.0658493407607515,0.118281107937699,0.146685330059382,0.184483733174489,0.201031865071246,0.208489731961954,0.199813088546556,0.173228421119772,0.15881448228231,0.110831004577325,0.0752211727700427,0.00691784934383055,-0.0410494622741947,-0.112101917253288,-0.161879241781081,-0.213939118045616,-0.25849434837538,-0.302399989776116,-0.332344056465021,-0.350186044061192,-0.34546713178355,-0.347667261514023,-0.324396786533683,-0.308688552168926,-0.266488953175246,-0.222752454925561,-0.157175120604709,-0.107535108299759,-0.0378852528915588,0.0250826359891146,0.09110654721019,0.14465352922218,0.186533668822649,0.227571375176931,0.246254046570176,0.245357355780189,0.242569620704861,0.223185978540635,0.198940028374305,0.136883047160671,0.0865691583923081,0.0158946510599428,-0.0466815286465964,-0.110245480447025,-0.179760373049153,-0.232635323983061,-0.288155731647872,-0.329328797635806,-0.35960117308536,-0.395065815949081,-0.394048002125099,-0.395958702055804,-0.374865588542996,-0.334879782561517,-0.292344160687133,-0.232849148585344,-0.179884259738758,-0.109481125455091,-0.043329638609668,0.0455028956835643,0.103352411759236,0.161940418223249,0.215029384295473,0.250219682362799,0.275013370457355,0.274215132383285,0.285772445872644,0.249503424529586,0.219787703464797,0.164158257498949,0.102389080249609,0.0296450294173625,-0.029615907784823,-0.102528807190646,-0.197430761583592,-0.245530704112749,-0.300700862684971,-0.361525777443914,-0.38787422311928,-0.409984188818441,-0.423223223732508,-0.416482947309252,-0.401562916340462,-0.367441080395849,-0.306493429471774,-0.257807709590111,-0.185870601255054,-0.11942145923126,-0.0270396753120331,0.0301464386377811,0.110294155384955,0.171416887585446,0.227178207497311,0.267192805293549,0.284095069239335,0.302877718877046,0.28677937424592,0.268082355556244,0.22781638125692,0.17780380443535,0.124770918282753,0.0398627951719081,-0.041498849412159,-0.113028320343209,-0.194330075230473,-0.26271541189228,-0.336814343931043,-0.37004672555264,-0.412242282519957,-0.445569076315628,-0.453115155598744,-0.44012906736822,-0.404927481954233,-0.377774734447246,-0.336346021110216,-0.26061328670376,-0.192122227764685,-0.118805254717428,-0.0404665454356567,0.0440245677625173,0.114399898297441,0.190012512492862,0.230432385464466,0.268139584083881,0.295068762070525,0.313334906067605,0.295683891849294,0.277887933759065,0.223734624312392,0.18221482786822,0.104151962938528,0.0328165100513208,-0.0419504635609632,-0.104127747138416,-0.195234488071943,-0.255231132670634,-0.322971124855948,-0.378184960828452,-0.417278805379428,-0.443374087676342,-0.457678805589738,-0.450119135221857,-0.421287222231234,-0.388153801658209,-0.34206628392073,-0.257686893306053,-0.194487693779579,-0.114888967547598,-0.0353259562327592,0.0498048254950194,0.126856445370628,0.174769648331933,0.234533530391073,0.284966465868862,0.289212031703153,0.306490821619899,0.291344874908462,0.280039025591843,0.218543905112635,0.177676584200681,0.106327506277115,0.0388454136385608,-0.0288448865988272,-0.111161573457858,-0.195974537406208,-0.254242051090932,-0.322580695726876,-0.382880067068918,-0.416471434402753,-0.441114311473204,-0.452563301537695,-0.443778180414091,-0.415217100712298,-0.383955398096856,-0.324276974965624,-0.267511269870424,-0.189220461930828,-0.10570666287208,-0.0405526695490222,0.0313857506959068,0.111561313783286,0.16293054748908,0.218746957067888,0.256335300423517,0.268108147865454,0.294052351660615,0.274251783570597,0.257037696739912,0.230146087770844,0.173601834198864,0.104839873358556,0.0469422134644854,-0.0342200845451773,-0.093548895183745,-0.192808792758522,-0.245883938254593,-0.313353740830533,-0.366834882728323,-0.409857751116503,-0.429117100433701,-0.440972742298182,-0.431772222662843,-0.415227743513459,-0.36804537278515,-0.314235832763838,-0.257794155504204,-0.181245350140561,-0.120658178578523,-0.0467884560668349,0.0275159154772086,0.0942864183262996,0.155942218495128,0.201740463867621,0.232258515852417,0.25996778069045,0.268508909141515,0.258879672203802,0.23350284227086,0.196800277659525,0.151131699613255,0.0883868823521483,0.0294347491081694,-0.036762819114559,-0.114347101405828,-0.168942519440828,-0.256709710391373,-0.295415577885239,-0.353520438385519,-0.374750584300714,-0.403179753600053,-0.410766743698181,-0.395058531122359,-0.385841339465877,-0.343076649514516,-0.303935633581985,-0.239731967477512,-0.171106792732071,-0.111427841189429,-0.0493187496813672,0.0159565751382172,0.0692881037910846,0.128572854944773,0.173051490620839,0.197819530972253,0.219162321811098,0.226060645258199,0.223387062879827,0.196469874126885,0.169535015047867,0.123547274217181,0.0850527329860715,0.0120601714912727,-0.0525195120235554,-0.112673085011218,-0.165910189872553,-0.216199064750978,-0.279639532262074,-0.323269862677484,-0.352189630214336,-0.361144307360733,-0.363331007221051,-0.374680430722222,-0.352083316294265,-0.322220285787721,-0.276735587932914,-0.225032668975457,-0.154281418545164,-0.122019833595566,-0.0460413113649655,-0.0034166720864748,0.0581425843067048,0.103082405891448,0.139244845509932,0.160219614165057,0.174563434246752,0.187119354051512,0.175363212084203,0.148696412510331,0.131792022975746,0.0977531342201382,0.0582570473489223,-0.00155837410084278,-0.0469158210881076,-0.103014167460485,-0.158295792747108,-0.196777207673219,-0.239134201024845,-0.290670796179842,-0.312225930369839,-0.318531528202032,-0.33333706547469,-0.33210962917218,-0.299223590047608,-0.284580952968593,-0.243144507974578,-0.196400640841663,-0.16086413441263,-0.0980878486385219,-0.0472852953067591,-0.0068481331878095,0.02029147468917,0.0608325063877259,0.0960794214811869,0.11321534622834,0.130517249247257,0.133252559698869,0.125425217188156,0.104820470579015,0.0836701001151548,0.0641784899880712,0.025979089577333,-0.0208353351485343,-0.0402228466238784,-0.100881694316031,-0.146185072018561,-0.174522579827583,-0.216116612096386,-0.242348860447545,-0.262545138712523,-0.278035664419049,-0.285143575633801,-0.273983579066803,-0.26400164656961,-0.245739771079537,-0.208062951763205,-0.176429889864429,-0.135244125379696,-0.099942350409702,-0.0690718953332067,-0.0301009198673021,-0.00630403522692556,0.0187558987540992,0.0387615033986134,0.0593617664560933,0.0625557513018435,0.0768303482999377,0.0640849183984009,0.057839677369991,0.0456958263208493,0.0312653976156583,0.00325955200621814,-0.0238878688806225,-0.0582568184251293,-0.0904341532559232,-0.112211535504743,-0.153764435068311,-0.165247566977202,-0.193034151587431,-0.212708905254202,-0.216408975544463,-0.218714992808602,-0.216386694054245,-0.210948460450697,-0.189418220543665,-0.17554418657052,-0.140252903705002,-0.119590789717433,-0.0939582769017621,-0.0526921940599448,-0.0546606591405228,-0.0266839324873991,-0.0117121170169185,-0.00951289371258886,0.00504164415287813,0.0013415279796066,0.0183012629349712,0.00638570411276555,0.00628583890667728,-0.00861415616353362,-0.0176855984566547,-0.0439269355708781,-0.0464253155012026,-0.0557004362191885,-0.0846020554349939,-0.0969092975658402,-0.114745506971611,-0.124976202000538,-0.140525348789341,-0.148156137166327,-0.161778504568306,-0.158773311871487,-0.1485341831089,-0.144844683226921,-0.147130557036272,-0.138655286677542,-0.11435499203183,-0.0989809548104111,-0.0732963679893581,-0.0771890254134648,-0.0595053593123874,-0.0744493133581759,-0.060502121288658,-0.0669218336674226,-0.053518338706424,-0.0451686797969564,-0.0534626536568012,-0.0636976595573818,-0.0597065037977917,-0.0700481084163618,-0.065996459570098,-0.0649781725951473,-0.0585897776226523,-0.0712127612876859,-0.0771363975286635,-0.0786160406867428,-0.0871401921084026,-0.0978727438848371,-0.0854015189796082,-0.0934997032944692,-0.0926855209616674,-0.0807361709784672,-0.0894103760038994,-0.0824276852018024,-0.0919023225383747,-0.0749018826475123,-0.0856069707507197,-0.0711310294550455,-0.08029672104774,-0.078030675429273};

float mz[] = {0.719598844219873,0.734730417274361,0.695726488398947,0.658168822018206,0.577956800494641,0.510872292150174,0.393446097514671,0.282487930840363,0.15404757471848,0.0350809440684939,-0.0851729483464161,-0.184349814165577,-0.281555876411966,-0.37543696985943,-0.417260315218521,-0.454472110382611,-0.452425936805769,-0.430522467234075,-0.392039427764889,-0.323926288641655,-0.224255820976191,-0.11995882774885,-0.0162703389128644,0.101200350710444,0.222254017997427,0.365185994132257,0.461242114096043,0.557271875027411,0.634843500471641,0.687456859450145,0.719156291535919,0.729044935489088,0.708037292014501,0.661178427931559,0.586655936935322,0.5064151309404,0.395056207306769,0.285331187275525,0.169003928602278,0.0302543135826218,-0.0804962038696539,-0.198811180824539,-0.28288269194168,-0.37800897800534,-0.419756069811531,-0.445076731293439,-0.45244797122326,-0.444867598836022,-0.382901191127,-0.319286873952617,-0.227469880277835,-0.130523584638161,-0.0202803353816169,0.108206136409748,0.24053953569262,0.356360424122515,0.459490659341088,0.554639918944428,0.638910046277298,0.688923797861764,0.713135745903981,0.721190268644116,0.695652394486704,0.657948932874715,0.58395833147232,0.488081730491877,0.389535164090908,0.281000795325536,0.158640019042695,0.0349382885687868,-0.0869984256626097,-0.195382871088382,-0.295035068247506,-0.368659874391675,-0.414646456462424,-0.448542998943858,-0.449646177301598,-0.444978642233388,-0.385795766099401,-0.307574388838654,-0.225254012125381,-0.11773185858738,-0.0104670755100592,0.127845761149197,0.2327243262118,0.36154651313995,0.461260647000541,0.566744085436942,0.643475060555386,0.686268047255423,0.705778660731015,0.726289235697112,0.708762581501448,0.653259618664849,0.581106509293327,0.500127438146321,0.394461535635577,0.265253090807161,0.156005483150099,0.0265501208887051,-0.0818461949174684,-0.199991604703889,-0.293303840701454,-0.368584186027645,-0.420461829236449,-0.442322936413275,-0.451007674798587,-0.426108602050808,-0.371070070847471,-0.314274929562448,-0.226439492514552,-0.126277988096699,-0.00202786134793032,0.119215698011741,0.243097814377799,0.35890181430714,0.466551497065743,0.57182706413982,0.631664629378661,0.688944694824734,0.716494759856028,0.72049361964886,0.702923281987996,0.655987824605058,0.579199679336035,0.494687207068417,0.375878780097891,0.25989927731192,0.144024930661629,0.00641178789187169,-0.0952959439731273,-0.203073285498657,-0.298442661065653,-0.37293628886958,-0.41906349230317,-0.457078592177125,-0.44439770502308,-0.426447834561077,-0.389881918384317,-0.3182528893571,-0.217843820366334,-0.120934356285361,-0.00697578901613699,0.11445109017231,0.238197436992072,0.366549586867572,0.470889630962813,0.568654424973064,0.639674125360439,0.698930028151872,0.71917299991158,0.723404010205047,0.694838550017982,0.642083019066822,0.565184116713795,0.478855775933991,0.36923125208616,0.263991190891385,0.132835427167905,0.0151990318133261,-0.106905645184295,-0.209250294552668,-0.309509904928874,-0.380430908678676,-0.42436350062181,-0.451726186729948,-0.449718257222981,-0.430314397942383,-0.374996947968465,-0.316505101464827,-0.212940689348568,-0.104096610273657,0.01954804347369,0.133519409258566,0.250123665615611,0.385352037259325,0.477153002241773,0.572260919955876,0.647666476711537,0.702694137444986,0.722415907253566,0.725965800761756,0.692535041651953,0.630715073080711,0.56716756634642,0.476622783250768,0.378797781785222,0.254899376741589,0.12639985090927,0.00922372260828135,-0.111075055738904,-0.215509444949579,-0.304081770492344,-0.388433648432807,-0.434527869224956,-0.451443442844671,-0.454702320424889,-0.424651567032793,-0.376990750191607,-0.290006036830593,-0.208008015302372,-0.105518334384164,0.0150228676953743,0.145852149963567,0.262058163785722,0.391860314447561,0.484865506780235,0.579132264250147,0.648552704068107,0.698489892544684,0.724849115559559,0.717928531151595,0.68962416214114,0.63163037839228,0.563206898028607,0.479788862623198,0.378643576825229,0.245754943324495,0.114992418385946,-0.0072740027630389,-0.126350314897003,-0.215687625133576,-0.318052839535599,-0.393821324555185,-0.42399229815,-0.459760664873671,-0.456308012601181,-0.433537116971263,-0.368006742041717,-0.290326743928744,-0.206922506121097,-0.095877799013353,0.0188523952281734,0.147439905329952,0.275634562745506,0.378864341257392,0.485473531446126,0.577712608646297,0.642776736825311,0.693532644294803,0.723067913763426,0.715649650176876,0.695686495366332,0.646448794109479,0.566669027550982,0.468469197745552,0.35939397366161,0.24359059559562,0.110525002868391,0.000872097466445349,-0.125753775764116,-0.230524550536441,-0.32174988855606,-0.377281505434658,-0.430719551929736,-0.457030379796945,-0.447962423309792,-0.42381892724131,-0.373607513261235,-0.290854362199283,-0.202505786299382,-0.0963834595672433,0.023783683383326,0.151436072855431,0.269155474701463,0.380188515814129,0.4960328035883,0.588352435170339,0.642525759790999,0.712458330264718,0.727324449894633,0.719125434007048,0.685440040576986,0.638666828690047,0.554255784638532,0.472280438288484,0.348299050462246,0.247985246453556,0.105966327410423,-0.0122484883790791,-0.128611318402052,-0.231433774589948,-0.321892571903099,-0.381009587625172,-0.431548528516691,-0.458670541078621,-0.447382985809091,-0.414003568495114,-0.37265381344975,-0.293303176749684,-0.197081013422896,-0.0884049165950268,0.0344987058955538,0.154440255489293,0.275028885741495,0.404401102460634,0.496414721487653,0.588901721304113,0.653478599519776,0.703540125476957,0.719254431701005,0.704939926696191,0.691079069440709,0.63454154228926,0.559480329994191,0.461908271402188,0.345792433185387,0.237532756215657,0.108069601801726,-0.0129169399298926,-0.124468596391699,-0.244352935683744,-0.316592704205831,-0.386490601193535,-0.429074402241018,-0.457940700319913,-0.46126054434572,-0.422265705234939,-0.3748072356275,-0.284503439242366,-0.200759919358351,-0.0784532672635964,0.0359116458977161,0.155287185618132,0.285814010771627,0.39209786355936,0.494484201767659,0.586545053498971,0.658389425983068,0.697392717670437,0.727114898199374,0.731772659365917,0.688602737383087,0.632998205134653,0.554659631155448,0.461937971461552,0.343319729716034,0.23218399327718,0.107240032262747,-0.0248876000988621,-0.129322773382367,-0.242516446620513,-0.328047328726632,-0.390986060483332,-0.429117833757414,-0.45736586283002,-0.449326078921445,-0.420588594863407,-0.355734220919089,-0.283043214225851,-0.188460718138383,-0.0776023146272276,0.0359015575700724,0.168040600333537,0.27874518314009,0.40318770263677,0.507656044976514,0.595389825733352,0.667579759860102,0.708385901642128,0.731545964675896,0.710134209301101,0.682495624301113,0.628107030647498,0.542989563436146,0.454995238578797,0.346756461986006,0.227288272339958,0.105831613964669,-0.0115309216812643,-0.129115968099383,-0.233726268121114,-0.330842599311172,-0.390566095931994,-0.444518492560016,-0.459165843682183,-0.450859234152544,-0.413468878629275,-0.365607479561109,-0.281147943842241,-0.18955519421554,-0.0761696284761548,0.0498203637377328,0.162610770935696,0.274705611504482,0.406404958892982,0.512266918830538,0.60084653039996,0.670461495918137,0.704308994518645,0.730715172523185,0.729147662504848,0.696562686684722,0.628383530564744,0.550393900284929,0.451458880222534,0.357406606412838,0.23419234884343,0.0918572448244481,-0.0237220993082039,-0.136865499319634,-0.251420303757009,-0.326272533858572,-0.386180217025097,-0.432626210072522,-0.458271647275363,-0.448103812260626,-0.413415045302853,-0.365819399890706,-0.278312343300343,-0.173006378624514,-0.0628197159468436,0.0340936626682891,0.167761455027491,0.283498609068217,0.408651908555842,0.500660055535028,0.595837438984841,0.655466277970311,0.708658776778219,0.719760648087734,0.723928901699309,0.693194468339642,0.625899053047466,0.555249816029265,0.457391052867125,0.3473259677316,0.22637896888879,0.0987920669324288,-0.0236916119026923,-0.139181667970454,-0.24725148893057,-0.326804801830672,-0.391463501618318,-0.4450634125542,-0.455423570771323,-0.449530792029564,-0.415418009604142,-0.355986742710896,-0.29012110627211,-0.177629109928944,-0.0819132064979235,0.0296266367538134,0.160499820191116,0.283887150913167,0.406836200210221,0.506393553482854,0.592638606669423,0.663275900077477,0.706514869909513,0.734492363436829,0.721854886543678,0.687178758994474,0.618946780846504,0.547371987461285,0.458369586178396,0.352866264000613,0.207759552542118,0.0993292236975229,-0.0170321791291869,-0.133318088860922,-0.237598388284927,-0.33424281271724,-0.410199325359282,-0.433409414054242,-0.453043999369363,-0.454760333476694,-0.412747541939461,-0.356153940047406,-0.287486629742046,-0.187303680300267,-0.0720266370465994,0.0380212037763471,0.168388534130077,0.294687412555519,0.407344936567044,0.490624073863967,0.595426948702788,0.669488806866068,0.69643065604036,0.727701229116252,0.713417367188722,0.679494928476236,0.631800781083294,0.552735099538752,0.468966478683904,0.338278324167689,0.224820211007199,0.097961626401414,-0.0148390091377354,-0.134520108633963,-0.238875612617098,-0.324165871656585,-0.398704133990333,-0.424206623223701,-0.459761274855554,-0.453401913043736,-0.423295253354598,-0.366801602931051,-0.281514338760484,-0.190769664116959,-0.0738334095128573,0.0511680297066875,0.162330344528983,0.273470340025877,0.408953346567692,0.513839704705529,0.591773002612056,0.659902821351105,0.705923597511917,0.722112605305408,0.721297590871629,0.690778663785228,0.642342120852934,0.556447969922504,0.455710997872414,0.343025395203364,0.222033232122867,0.107633842735217,-0.0166973325765174,-0.138873599282251,-0.231941155096429,-0.312121865097601,-0.387130600886848,-0.424715343805443,-0.447987070112204,-0.459748257301818,-0.408429032202148,-0.363255638747815,-0.272311345733478,-0.192375437443667,-0.0758462468418226,0.0398210072042726,0.160345054108252,0.293306144586109,0.405531904977474,0.507716238144568,0.580961263115428,0.654542478554265,0.698148162394629,0.726534223835132,0.721041457507751,0.69013442507125,0.628320237597189,0.557404586622523,0.455605353273659,0.355470344573778,0.236378525273041,0.114689386709181,-0.0157189409523438,-0.131969520392931,-0.230398120712599,-0.314755018462497,-0.398746739565062,-0.441489042073794,-0.45417372686151,-0.448691804703379,-0.422284718847544,-0.372878809712957,-0.291289211542639,-0.196015069837302,-0.0826823226759287,0.0400595954032749,0.16066642452837,0.277393742646386,0.395688391977551,0.494918008141648,0.59243180374737,0.663308707836876,0.698249512607304,0.729492771907453,-0.449655085064519};

#define N 9

void inverter_matriz(float matriz[N][N], float inversa[N][N]) {
    // Inicializando a matriz identidade na matriz inversa
    for (int i = 0; i < N; i++) {
        for (int j = 0; j < N; j++) {
            if (i == j) {
                inversa[i][j] = 1;
            } else {
                inversa[i][j] = 0;
            }
        }
    }

    // Aplicando o método de Gauss-Jordan
    for (int i = 0; i < N; i++)
    {
        float pivot = matriz[i][i];
        for (int j = 0; j < N; j++)
        {
            matriz[i][j] /= pivot;
            inversa[i][j] /= pivot;
        }

        for (int k = 0; k < N; k++)
        {
            if (k != i)
            {
                float fator = matriz[k][i];
                for (int j = 0; j < N; j++)
                {
                    matriz[k][j] -= fator * matriz[i][j];
                    inversa[k][j] -= fator * inversa[i][j];
                }
            }
        }
    }
}
void main()
{
    //Inicializa e define o quantidade de medidas
    int tam1 = (sizeof(mx)/sizeof(float));
    #define tam tam1

    float sf = 0.5;

    //Cria a matriz H
    float mat_H[N][tam], my_2[tam];
    for(int i=0; i < tam; i++)
    {
        mat_H[0][i] = mx[i]*mx[i];
        mat_H[1][i] = mx[i]*my[i];
        mat_H[2][i] = mx[i]*mz[i];
        mat_H[3][i] = my[i]*mz[i];
        mat_H[4][i] = mz[i]*mz[i];
        mat_H[5][i] = mx[i];
        mat_H[6][i] = my[i];
        mat_H[7][i] = mz[i];
        mat_H[8][i] = 1;
        my_2[i] = -(my[i]*my[i]);
    }

    //Multiplicação da matriz H por sua transposta
    float H_Ht[N][N], inv[N][N];
    for(int i=0; i < N; i++)
    {
        for(int j=0; j < N; j++)
        {
            H_Ht[i][j] = 0;
            for(int k = 0; k < tam; k++)
            {
                H_Ht[i][j] += mat_H[i][k]*mat_H[j][k];
            }
        }
    }

    inverter_matriz(H_Ht, inv);

    //Multiplica a inversa por H transposta
    float mul_mat[N][tam];    
    for(int i=0; i < N; i++)
    {
        for(int j=0; j < tam; j++)
        {
            mul_mat[i][j] = 0;
            for(int k=0; k < N; k++)
            {
                mul_mat[i][j] += inv[i][k]*mat_H[k][j];
            }
        }
    }

    //Resultado da psedo-inversa
    float X[N];
    for(int i=0; i < N; i++)
    {
        X[i] = 0;
        for(int j=0; j < tam; j++)
        {
            X[i] += mul_mat[i][j]*my_2[j];
        }
    }


    // Segundo passo, encontrando os parâmetros
    float psi7, psi8, divs, n1, n2, n3, n4, n5, n6, bx, by, bz, sx, sy, sz, rho, phi, lambida;

    psi7 = 2*(X[4]*pow(X[1], 2) - X[1]*X[2]*X[3] + pow(X[2], 2) + X[0]*pow(X[3], 2) - 4*X[0]*X[4]);
    bx = -(pow(X[3], 2) * X[5] + 2*X[2]*X[7] - 4*X[4]*X[5] - X[1]*X[3]*X[7] + 2*X[1]*X[4]*X[6] - X[2]*X[3]*X[6]) / psi7;
    by = -(pow(X[2], 2) * X[6] + 2*X[0]*X[3]*X[7] - 4*X[0]*X[4]*X[6] - X[1]*X[2]*X[7] + 2*X[1]*X[4]*X[5] - X[2]*X[3]*X[5]) / psi7;
    bz = -(pow(X[1], 2)*X[7] - 4*X[0]*X[7] + 2*X[2]*X[5] + 2*X[0]*X[3]*X[6] - X[1]*X[2]*X[6] - X[1]*X[3]*X[5]) / psi7;
    
    psi8 = -pow(X[1],2)*pow(X[7],2) + 4*X[4]*X[8]*pow(X[1],2) - 4*X[8]*X[1]*X[2]*X[3] + 2*X[1]*X[2]*X[6]*X[7] + 2*X[1]*X[3]*X[5]*X[7] - 4*X[4]*X[1]*X[5]*X[6] - pow(X[2], 2)*pow(X[6], 2) + 4*X[8]*pow(X[2], 2) + 2*X[2]*X[3]*X[5]*X[6] - 4*X[2]*X[5]*X[7] - pow(X[3], 2)*pow(X[5], 2) + 4*X[0]*X[8]*pow(X[3], 2) + 4*X[4]*pow(X[5], 2) + 4*X[0]*X[4]*pow(X[6], 2) + 4*X[0]*pow(X[7], 2) - 16*X[0]*X[4]*X[8] - 4*X[0]*X[3]*X[6]*X[7];
    
    divs =  2 * pow(fabs(X[4]), 3) * (X[4] * pow(X[1], 2) - X[1] * X[2] * X[3] + pow(X[2], 2) + X[0] * pow(X[3], 2) - 4 * X[0] * X[4]);

    sx = -pow(X[4], 3) * sqrt(psi8 * (-pow(X[3], 2) + 4*X[4])) / (divs);
    sy = -pow(X[4], 3) * sqrt(psi8 * (-pow(X[2], 2) + 4*X[0]*X[4])) / (divs);
    sz = -pow(X[4], 3) * sqrt(psi8 * (-pow(X[1], 2) + 4*X[0])) / (divs);
    sx = sx/sf;
    sy = sy/sf;
    sz = sz/sf;

    rho = (2 * X[1]*X[4] - X[2]*X[3]) / (2*pow(X[4], 2) * sqrt(-(X[4]*pow(X[1], 2) - X[1]*X[2]*X[3] + pow(X[2], 2) + X[0]*pow(X[3], 2) - 4*X[0]*X[4]) / (pow(X[4], 3))));
    rho = -atan(rho);
    lambida = -atan((X[3] / X[4]) * sqrt(-(pow(X[4], 2)*(X[4]*pow(X[1], 2) - X[1]*X[2]*X[3] + pow(X[2], 2) - 4*X[0]*X[4]) / (2*pow(X[1], 2)*pow(X[3], 2)*X[4] - 4*pow(X[1], 2)*pow(X[4], 2) - 4*pow(X[1], 2)*pow(X[4], 2) - X[1]*X[2]*pow(X[3], 3) + pow(X[2],2)*pow(X[3],2) + X[0]*pow(X[3], 4) - 8*X[0]*pow(X[3], 2)*X[4] + 16*X[0]*pow(X[4], 2)))));

    n1 = -pow(X[1], 2)*pow(X[7], 2) + 4*pow(X[1], 2)*X[4]*X[8] - 4*X[1]*X[2]*X[3]*X[8] + 2*X[1]*X[2]*X[6]*X[7] + 2*X[1]*X[3]*X[5]*X[7] - 4*X[1]*X[4]*X[5]*X[6] - pow(X[2], 2)*pow(X[6], 2) + 2*X[2]*X[3]*X[5]*X[6] + 4*pow(X[2], 2)*X[8] - 4*X[2]*X[5]*X[7] - pow(X[3], 2)*pow(X[5], 2) + 4*X[1]*pow(X[3], 2)*X[8] - 4*X[0]*X[3]*X[6]*X[7] + 4*X[4]*pow(X[5], 2) + 4*X[0]*X[4]*pow(X[6],2) + 4*X[0]*pow(X[7], 2) - 16*X[0]*X[4]*X[8];
    n2 = pow(X[1], 2)*X[4] - X[1]*X[2]*X[3] + pow(X[2], 2) + X[0]*pow(X[3], 2) - 4*X[0]*X[4];
    n3 = 2*pow(X[1], 2)*pow(X[3], 2)*X[4] - 4*pow(X[1], 2)*pow(X[4], 2) - X[1]*X[2]*pow(X[3], 3) + pow(X[2], 2)*pow(X[3], 2) + X[0]*pow(X[3], 2) - 8*X[0]*pow(X[3], 2)*X[4] + 16*X[0]*pow(X[4], 2);
    n4 = 4*X[4] - pow(X[3], 2);
    n5 = 4*X[0]*X[4] - pow(X[2], 2);
    n6 = 4*X[0] - pow(X[1], 2);

    phi = -atan((fabs(X[4])*sqrt(n1*n5) * (2*X[2] - X[1]*X[3]) * sqrt((X[4]*n4*n6) / n3)) / (pow(X[4], 2) * sqrt(-n2 / X[4]) * sqrt(n1*n6) * sqrt(-(n2 * n4) / n3) * sqrt(-(n4*n5) / (X[4]*n2))));


    printf("The estimated parameters:\n\n");
    printf("The sacle factors:\n");
    printf("%.4f\n", sx);
    printf("%.4f\n", sy);
    printf("%.4f\n", sz);
    printf("\nThe offsets:\n");
    printf("%.4f\n", bx);
    printf("%.4f\n", by);
    printf("%.4f\n", bz);
    printf("\nThe angles:\n");
    printf("%.4f\n", rho);
    printf("%.4f\n", phi);
    printf("%.4f\n", lambida);
}