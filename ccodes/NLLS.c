#include <stdio.h>
#include <stdlib.h>
#include <math.h>

float mx[] = {0.142506096736581,0.48477273842692,0.898416134288985,1.18866934092113,1.28638282484633,1.18022088795672,0.905480748047918,0.486466689323502,0.00630546696851349,-0.450182035363247,-0.802796013545967,-1.02240878074603,-1.01224566068609,-0.818361047732248,-0.441272749154835,-0.0066908789567775,0.481030236488676,0.897656257054875,1.17467346011414,1.28045622558302,1.17412796231086,0.902894668832361,0.483060223251682,0.00133938393936072,-0.459357423236952,-0.816845337218098,-1.00781235077313,-1.02363676466339,-0.812209028458603,-0.456577763363351,0.00413353327400062,0.485487984963605,0.887635968107014,1.1686673979238,1.27063263648233,1.17282216409445,0.891146806469732,0.473027534781377,-0.0122472677054964,-0.448107586137838,-0.802327443539712,-0.998096485421477,-1.00666274476886,-0.809852768418697,-0.451838997975173,0.00559828285527209,0.475170559349578,0.867397900448734,1.15770163763024,1.25559333384406,1.15743154617374,0.876063465077044,0.470905560331128,0.00716686530107775,-0.445503402856862,-0.782126065328659,-0.965696738766263,-0.973215260818454,-0.781395025188149,-0.442096415809112,0.0077077052018974,0.458857135538637,0.864391478429653,1.13101079436603,1.21480619029937,1.13048168168828,0.859293026921171,0.46504674230238,0.00817865498397723,-0.422028782880796,-0.76438039837493,-0.95321397049263,-0.941978470974351,-0.750225671553838,-0.41797101637166,0.0172730748317763,0.447920958496021,0.837495461818737,1.09530261854233,1.18562771059392,1.09338519601577,0.828951186101752,0.457653601184018,0.0322140675817417,-0.403204389709053,-0.721228465819481,-0.906983975431097,-0.906776581089622,-0.720579545819494,-0.404263966268805,0.0138696433389726,0.434566812236826,0.79856184997514,1.05209587287157,1.14559001569343,1.04976500915488,0.796278714506868,0.433756338020262,0.0237020723137357,-0.379009242341776,-0.682159483590989,-0.859812734300883,-0.859678077674848,-0.690850589498329,-0.376636470088694,0.0133354051971012,0.421538137106537,0.76437804791912,1.00021675570426,1.0725588363478,1.00169352378659,0.771021717265515,0.417493010509032,0.0285627025773347,-0.352216954977755,-0.65175340098521,-0.803709048383504,-0.807491936239255,-0.646935167466795,-0.3557855667162,0.0210310307205853,0.393193466276071,0.721728967621376,0.943846301640171,1.01266021905686,0.929680257124124,0.729051848019714,0.405633908866236,0.0322030192543378,-0.328080123142398,-0.603098193041366,-0.74490607303633,-0.756558083941868,-0.598510895686151,-0.318843333289048,0.0309667567116837,0.377266572702608,0.676330024959945,0.88533825882934,0.947737053330891,0.881109348021163,0.664051661995288,0.382364808343692,0.0343554846043904,-0.282462258941498,-0.534928228254731,-0.6902907471767,-0.668657600178592,-0.538407025434167,-0.278946587002007,0.0345602937620077,0.352718609124071,0.62641567978009,0.801319661840107,0.870103809967107,0.804572009616852,0.629451859789016,0.356226277824743,0.0618545210808082,-0.25281453750528,-0.482528501988402,-0.605087920494688,-0.595323635689989,-0.484790181964828,-0.250552675111025,0.040711004173803,0.327773279228887,0.574765323556528,0.735080854597975,0.793258320846166,0.727864967397416,0.574508993158819,0.320999443071173,0.0686605987584148,-0.202163174788632,-0.411063166702406,-0.526754187714131,-0.531126087461039,-0.420589487615668,-0.223316474357386,0.0607649216426641,0.313105847577214,0.512082221180413,0.653372791923721,0.709871075875364,0.65784724621807,0.520157521158407,0.307637052962867,0.0659208033902776,-0.162789249403928,-0.335614339224077,-0.440350635698681,-0.444692877088701,-0.351711189469759,-0.165379986030026,0.0581031902075381,0.276406663399011,0.451506571676328,0.570610182197863,0.616141190965741,0.57753349427148,0.461130833009084,0.285773514579894,0.0737330869733054,-0.116240808379484,-0.268913666750368,-0.348106063272067,-0.34610629646248,-0.270399296600183,-0.122136685766571,0.0792296617233879,0.248890026647609,0.390783843796112,0.490982509734382,0.529322052346193,0.488649527515374,0.390764535423059,0.246158529985058,0.0868255832674762,-0.0781036627809044,-0.19636096216889,-0.265447229951052,-0.268294996176877,-0.181943585339616,-0.0839318212627422,0.0906900616143019,0.219122719474529,0.326462473102445,0.401795210236261,0.436938724674166,0.405956480828605,0.322820367815409,0.225250729287529,0.0898247005907894,-0.0394664563450897,-0.126482519051708,-0.180801488516468,-0.174768675805976,-0.11335329070263,-0.0136542035151013,0.097083683365704,0.182346107452822,0.257729268950944,0.30424482481384,0.322471051975027,0.302811917959791,0.273296242840448,0.182909833353482,0.103336919754469,0.0252073789727822,-0.0334719583326039,-0.0662415188406287,-0.0804986911271149,-0.039496333242209,0.0224966233168423,0.109460539235101,0.157926246294712,0.194937238792046,0.206471359311562,0.222068571946891,0.216445346630444,0.196989013102206,0.143758006384524,0.109939381030363,0.0656683077035431,0.0470154669307005,0.0282926995679232,0.0331092127472583,0.0532647938522868,0.0772979575828845,0.121046510774151,0.11416587235362,0.130702582445437,0.12332769843069,0.135092252185228,0.127627788462583,0.122582330891656,0.122093347297293,0.125647082231017,0.125017236614731,0.130808752433054,0.124510868156487,0.129135231972963,0.125855977856602,0.118709744269895,0.127170376658408,0.0924021573203022,0.0590991988297884,0.032598078573169,0.0288314690411358,0.0291862571770971,0.0570187731485386,0.0930070727915659,0.135837450551279,0.178783502406212,0.208978669231776,0.215547484251733,0.21495969261357,0.20472491444,0.183136150974851,0.134460531705448,0.0645314590130218,-0.00675765572051062,-0.055848021147873,-0.0815623052215039,-0.0675008198180764,-0.00466690524572165,0.0599882947609489,0.140218520895632,0.222164285219217,0.292089920037749,0.315586754594497,0.31836397273765,0.28225752703234,0.230311838686933,0.143052834660322,0.0287477144360448,-0.069068642577436,-0.141871551140237,-0.178415215514621,-0.148791027807278,-0.0735258760591709,0.0304260264704049,0.153675850323166,0.264182285452827,0.364275509741531,0.424214164491169,0.423142121733979,0.373507439721631,0.27195379355802,0.154069993681321,0.0148659272773729,-0.133603415923942,-0.231407357403516,-0.272679332156862,-0.236503152230286,-0.145891492725132,-0.00314565557273051,0.170905841528823,0.336744924750735,0.447829265294883,0.518909054996749,0.524190872467028,0.439066025159657,0.317087969917089,0.166302315514746,-0.0208493118566489,-0.207568728821787,-0.324740222301928,-0.367866943189279,-0.329217591360947,-0.21278011362661,-0.023720943401082,0.177865190333145,0.36569395317039,0.525253719246303,0.601724469644429,0.601044616068386,0.524763083771253,0.383071911751617,0.174014513631984,-0.0590960579455343,-0.269318574939608,-0.405204890175135,-0.463477752246581,-0.395592400334714,-0.249414050855016,-0.0589634263084879,0.179071119306766,0.414002256013149,0.602375142971738,0.689716922211881,0.690813212154189,0.591590470900554,0.423113368658325,0.188322191803433,-0.0821015814338044,-0.326432145539103,-0.481938184640516,-0.55447519670542,-0.481570698500952,-0.325858278644036,-0.0836137967764583,0.190834173746418,0.46398461917895,0.663016622068087,0.779655048620163,0.774891210208818,0.6710253029419,0.454463260028439,0.204905113324766,-0.109123670823607,-0.371254526491021,-0.559563762950792,-0.627323678696837,-0.559207632676633,-0.374360982226621,-0.105814625867418,0.211320467170826,0.495992888103536,0.739833075301159,0.859909972907798,0.861106674827734,0.734749122111262,0.505394554408308,0.204696120890497,-0.123203274726364,-0.431028145753404,-0.631013778079451,-0.696912862776666,-0.624147675733636,-0.42567303951073,-0.128786665069012,0.210822630188798,0.535939604518519,0.795205926108685,0.930726323590067,0.924123836859285,0.788615732073287,0.540708845266861,0.214553457354312,-0.140663581767462,-0.469464901455506,-0.689992252026651,-0.762055823275115,-0.680241731011284,-0.464203475558598,-0.153916915441342,0.217824252225395,0.567168741462713,0.846470371856065,1.00006159274148,1.00147821252208,0.847854535216493,0.566582184049153,0.218364111913724,-0.166243503546324,-0.516092302322529,-0.745290560875349,-0.835990909779549,-0.736074532086705,-0.521150622735025,-0.164543206255417,0.23516155208796,0.607633661458237,0.895780510096081,1.06107202221468,1.06342360990609,0.898305568980023,0.596244380221906,0.223412207494737,-0.194592507714795,-0.547157821837173,-0.803535191708379,-0.882733397692453,-0.796624207513142,-0.555061305797563,-0.185135429058005,0.239869219079326,0.631740048383404,0.943732112033215,1.11419888980128,1.11350789506574,0.951995352637181,0.621981579757234,0.226148314496966,-0.211121278036175,-0.570080222234988,-0.828661236715814,-0.934073199056055,-0.843524262167162,-0.576194861627893,-0.201503062130419,0.238849069213688,0.653582529008294,0.989027943367395,1.16866295947146,1.14681094320986,0.988737135128719,0.650997106004988,0.248573932151988,-0.216066933955521,-0.601048405128649,-0.870795464703755,-0.96717600290863,-0.873497647782377,-0.619294284852698,-0.198619693388387,0.226771616296759,0.67090561889042,1.01885745248358,1.1977932592763,1.18757473678643,1.01531469488833,0.664622729263194,0.242193937535523,-0.213661259658994,-0.635840402391358,-0.899200285131994,-0.990465287184045,-0.904371954205787,-0.628001310372294,-0.210209601525524,0.249082113536586,0.688147775521671,1.03493395096162,1.21917541576259,1.22811754208893,1.02578024845522,0.693622802866543,0.245052337447768,-0.233273445150332,-0.633418975554813,-0.927547011200776,-1.02174054850639,-0.929005754408912,-0.647376486705681,-0.224036847963313,0.258578283281553,0.699238800870786,1.06057567433595,1.26805389939931,1.25450294748044,1.04413342721577,0.70810381532659,0.251201318595704,-0.232923443250121,-0.653582211279147,-0.937661860903552,-1.03795580331829,-0.940858711231765,-0.646959448174284,-0.227173026476123,0.251893195130045,0.713259149017457,1.06501903731181,1.25935925138974,1.26490227964745,1.0757666989695,0.710237221708405,0.257373095335039,-0.238029077221617,-0.649778202769394,-0.940329468609285,-1.03798451602586,-0.941158239653968,-0.652097152439671,-0.237440908076339,0.25168150150792,0.703837146585469,1.06744677306875,1.26939482735123,1.27237668931696,1.07288187125024,0.705104492412169,0.252432062149879};

float my[] = {0.154217453189309,0.154025255248931,0.150279044539977,0.141769868127234,0.120229586155469,0.139393184648141,0.14498633851675,0.147485419076536,0.163516008578791,0.183792788054676,0.17838055888487,0.177670334969961,0.187391456841296,0.183368190692094,0.170526172657444,0.169911768170942,0.186089519364887,0.215555019059716,0.222718943300639,0.226921932153854,0.221782032669838,0.19942538543112,0.172648453227162,0.143253980601413,0.134720461117914,0.106012875231135,0.0888304338050992,0.0876785602041791,0.104918478717833,0.13192504950081,0.154098467829319,0.220532642309233,0.274231305038017,0.306360875360367,0.31678684991724,0.300949620919854,0.267600327836882,0.205683016654844,0.142981618967239,0.0840404366447053,0.0294867016049038,0.0191857135702976,0.00350336086544793,0.0342888565716318,0.0844880605842731,0.151190470406392,0.235076339705537,0.334959090854512,0.376506385110587,0.41632240080336,0.395048325186293,0.321212536068944,0.240040655568985,0.123511334280041,0.037762013773098,-0.0474033992695155,-0.0839899075119301,-0.0858091617032416,-0.0383329900342451,0.0425951702830344,0.127487531428092,0.264751423681138,0.38597428688158,0.465001615504963,0.493946691320652,0.471874752927002,0.394641337563806,0.262540066274683,0.125230219716061,-0.00255640901118626,-0.107229324967204,-0.176045637795099,-0.17370935006639,-0.112938958137362,-0.00655373695550982,0.123237813567386,0.289391163123211,0.449978468880307,0.54456590973279,0.5913379203336,0.544807921954044,0.44076278829718,0.294052885551823,0.111128406533736,-0.0503645009286721,-0.187386726379169,-0.237822478980892,-0.254836970510379,-0.182200608921719,-0.0429764883829349,0.115499548581291,0.324261559763039,0.512368919556018,0.632317311471439,0.668429699709015,0.626303879402578,0.503466949219646,0.323611061921978,0.113608808717867,-0.0800655171408827,-0.240178186393853,-0.326973783976082,-0.327974447756557,-0.242888375966584,-0.0913645843772886,0.10356782973829,0.347435979111221,0.558704330009162,0.694261278726042,0.742276326721072,0.699507266821376,0.559880908659033,0.346044410413084,0.0955797170807144,-0.136599520771667,-0.298517116104821,-0.405368092672927,-0.411170138854593,-0.303841109378885,-0.127610344371567,0.100258049997879,0.359541359498224,0.593141414885127,0.759161242435272,0.827432556360598,0.765889065916989,0.599145890284833,0.36350632850866,0.100738618824903,-0.163659917773702,-0.378505911334689,-0.475657085614365,-0.482453904089814,-0.373554723026442,-0.170564427584336,0.0910852156746113,0.381523836456016,0.650491536325917,0.820595230202636,0.883268020331185,0.818016515513838,0.645397262476831,0.379961218276428,0.0846026521392001,-0.200866165169298,-0.424357164932889,-0.551566027545744,-0.551215035779985,-0.418088013725017,-0.200498901201444,0.0874007537663283,0.398292816665473,0.689468376583177,0.887887349054175,0.94558272591257,0.894690461007191,0.68445354719478,0.400454971083999,0.0888239600782072,-0.235797953728187,-0.480445421181533,-0.611072324696173,-0.607432605064121,-0.483751913685478,-0.222412706354263,0.0837096844824154,0.418068767602082,0.714541107566566,0.938346357589486,1.00771422640865,0.945075418368374,0.736521378918201,0.422260176859149,0.0693521422277477,-0.256599555090894,-0.523552549661567,-0.665748904293045,-0.655861063453069,-0.52183383848112,-0.262829267150415,0.0729477986145976,0.450045167614534,0.772031119892115,0.976383965715308,1.05028125496605,0.991833956715712,0.76709070467088,0.447088661933191,0.0778853131398737,-0.288201790701777,-0.577499421195317,-0.713772481845481,-0.721575665680292,-0.557291921842776,-0.28765713169904,0.0716197821450059,0.455411402221986,0.792006203231299,1.02191078228993,1.09731972860157,1.02823929643483,0.798088941580408,0.450444466873559,0.0634389213571503,-0.314669526017054,-0.597920315469586,-0.752727298379358,-0.754399621437986,-0.600946066036294,-0.306154150903554,0.0557524473485666,0.470951838137683,0.815616337438473,1.05454840876749,1.14743944950498,1.05591511855101,0.818564366314329,0.464019267080007,0.0592399603004023,-0.330285309261922,-0.628437316277965,-0.807758894910235,-0.796830528817679,-0.629372565011738,-0.32963967983578,0.0644537355806429,0.477191050462817,0.843834433266423,1.0867283555907,1.17615088854161,1.08367666288886,0.835248736464912,0.470020773838895,0.0591197252078249,-0.344621789741264,-0.646619379630726,-0.816929806375506,-0.836506626070812,-0.654742995188524,-0.339263373768801,0.0530726680650871,0.479923122018104,0.850482963260071,1.10124320907626,1.20142773680876,1.10203715091581,0.866485531042104,0.469837595887051,0.0568220069424852,-0.352950150089225,-0.662815291774919,-0.845928762099432,-0.846702245196101,-0.674137708393165,-0.358925960936505,0.0467298982915857,0.483669474153151,0.866524422109936,1.11039479511594,1.19589924537965,1.12552329519906,0.866640264734266,0.478701078327298,0.0471692825203072,-0.36316793795574,-0.697388499637319,-0.865028112934896,-0.859413317296287,-0.681181925947968,-0.346471710219608,0.0514011412433892,0.490999266661981,0.863871153944509,1.12443595958742,1.23137846727473,1.13096239701738,0.866159646923833,0.48133248328767,0.0564669556106203,-0.366330900230955,-0.694429538927545,-0.872303037135594,-0.870694887020469,-0.68266022318028,-0.365467521916007,0.0476623911955304,0.496745915523999,0.870761168858479,1.12279053497358,1.2089634443707,1.12395019872804,0.872404462128821,0.494790764938,0.0602557230865138,-0.3582297747525,-0.695310664041269,-0.852027931433599,-0.868263689585067,-0.695894055226503,-0.363283887855373,0.0514401083876724,0.483068525901107,0.857515750771759,1.10728824761006,1.20178346853918,1.11725058015386,0.862294418709002,0.474639941427584,0.057370275511263,-0.358896595868612,-0.678525240629788,-0.850620757693756,-0.856817481643879,-0.692393102228224,-0.35219317862279,0.0622286169182338,0.477725873340004,0.841424484060517,1.10357207512386,1.17612225583237,1.10660693022143,0.851347145399068,0.483204036425977,0.0472717797130217,-0.347823771973927,-0.669488112535899,-0.827307534871607,-0.840683494835287,-0.669442864323146,-0.35217642316699,0.0547330497992873,0.475237200978393,0.836335596338003,1.06948504198447,1.16016764023728,1.07081805375742,0.826339260317318,0.466724323256909,0.0614283331855654,-0.332424345993228,-0.630462139418245,-0.828205885467686,-0.810433697760166,-0.642102169508013,-0.346973982636166,0.0490157549216239,0.453393646812543,0.808535643071984,1.03556275705406,1.12782471225541,1.04272967839729,0.811627489853809,0.459274999047273,0.0658141784300419,-0.323896249697832,-0.614535650011659,-0.780652886239931,-0.779653309815089,-0.612669987819865,-0.323034820165235,0.05666112340347,0.453758150568306,0.784935615821536,1.00024560458928,1.09016165618691,1.00660587962208,0.777658628722312,0.451201328368423,0.0670575586251859,-0.297632081373325,-0.582655521213254,-0.749647909004143,-0.736218689377465,-0.581836994576091,-0.310156894007679,0.0648320474484133,0.438633212774906,0.760334243161382,0.962880874803718,1.03878377571437,0.969194902712387,0.747477790738467,0.427291490650002,0.0713256210123332,-0.269534108616544,-0.544991765447803,-0.690568772803633,-0.705948271134611,-0.541217505457983,-0.268407086051478,0.0691469888027204,0.425303133297058,0.715024288617703,0.907694128179694,0.981709966086587,0.902365145619056,0.719352042317292,0.415158293975706,0.0738963091337646,-0.257603537365089,-0.499838727336494,-0.647070471888978,-0.645939349604546,-0.495248955833181,-0.248685427234346,0.0729386684416288,0.401196634686453,0.659947071099507,0.853204015560972,0.92146256111781,0.855435398214589,0.669190443903192,0.39711664317204,0.0883491191319724,-0.213139316428259,-0.459311140463808,-0.583530650908877,-0.591783926483445,-0.44637080914105,-0.217340452814453,0.0892328843378674,0.368376759426826,0.635200833184891,0.812755922500776,0.85647822854455,0.802625078361718,0.621392171023112,0.366888464594221,0.0808630296891207,-0.196259156479842,-0.400837902717268,-0.505965880272254,-0.506125811955788,-0.39748017278741,-0.185714832491134,0.0891441201108812,0.357288473634635,0.579019878650732,0.721470487466038,0.795850210819482,0.7338253241283,0.586480845702275,0.354587307433491,0.0988690532608016,-0.154620599917605,-0.343689119517833,-0.448406015316963,-0.436418481477982,-0.344132853660209,-0.15414821232258,0.0929251568011567,0.325631056018973,0.533252215957965,0.659434795251404,0.711605232678215,0.646617630555305,0.533217507699308,0.332922869766323,0.0995444274662328,-0.103376482515858,-0.281957184975629,-0.374239751216615,-0.36645972409332,-0.27599275558646,-0.108571509009612,0.102700784372647,0.306194896812008,0.487779696962218,0.593867666293583,0.631680043653616,0.591036721448734,0.469883345449536,0.303799811739425,0.110667275609193,-0.0749072722239506,-0.211924759609221,-0.291477275168976,-0.28834642854863,-0.218580601995129,-0.0689397117024496,0.111558794033368,0.282157534234494,0.418762351976251,0.520016405730725,0.542012064311117,0.527406640664217,0.426044414637048,0.284192110269091,0.116864773521282,-0.0250056380620502,-0.149712000513757,-0.199615853627321,-0.201339457102779,-0.148609157214982,-0.0297964856241613,0.115615117906076,0.248633588570994,0.358780159044083,0.428359307469031,0.454654868708253,0.427723342455064,0.362558210842837,0.243218144521923,0.132351856053008,0.0125325811205665,-0.0788331212074048,-0.127304309375023,-0.131493253994009,-0.0835299657229906,0.0218683603088365,0.132885135427907,0.218203776970978,0.300351747286816,0.352355370852404,0.366402589441658,0.346896316235801,0.30618627218512,0.213438343767439,0.148187310197583,0.0662639337672434,-0.00591953108340368,-0.039816039391151,-0.0290316305179459,-0.00534507623647613,0.048241366889999,0.135676055741974,0.201947064240704,0.233262472920678,0.263152451026226,0.284753036754852,0.275338641176226,0.232303001790155,0.19606006986587,0.155958716302471,0.109430070020677,0.0731479739600003,0.0418254162172027,0.0502378411977177,0.0669741382207256,0.110628350463391,0.158806009541421,0.179610292499801,0.180165674505862,0.184098129302897,0.18643458966927,0.176899471748755,0.177798087494954,0.178497555954973,0.160748540862703,0.148039994538431,0.139232720857423,0.133671642408524,0.129910508199596,0.146471474107341,0.149736864320166,0.147971741264979};

float mz[] = {0.70704758833564,0.658030874758403,0.486116727089203,0.190692594106458,-0.136460651014697,-0.487758245608375,-0.765473556004787,-0.951641438125104,-0.97638363438337,-0.876513662514461,-0.640634889214137,-0.324539546370364,0.0305354924140207,0.333060596250562,0.575628347784782,0.678488900333325,0.654606232821966,0.47223525815141,0.191354226904498,-0.143239322951963,-0.488066073622625,-0.760141971532409,-0.945596974537106,-0.977666825461302,-0.879571767328123,-0.653031485484401,-0.336071757509002,0.0196001233764214,0.342407211402583,0.578995692420775,0.682147023945605,0.654031030134327,0.482804729109835,0.200857135557189,-0.14522120063631,-0.470371647135842,-0.76295634796563,-0.947270215831297,-0.976355895741543,-0.889877088460427,-0.650902589766973,-0.347782730301769,0.0125770162423159,0.338375437700884,0.565380591736873,0.686661780048123,0.648353772226452,0.488370656306739,0.190873262074668,-0.13897824154009,-0.477728537580761,-0.764670265408041,-0.943541208965442,-0.977288025981503,-0.88552306228458,-0.654953908952807,-0.335539085207973,0.000141609662432129,0.326327074605505,0.571226277485102,0.683897761268168,0.655363216351937,0.487936896114973,0.209664182224454,-0.132855425650347,-0.471015644537305,-0.761949733293158,-0.949678677410614,-0.99107793125673,-0.883120788713652,-0.657602451344427,-0.338257638223929,0.010194104472304,0.332674663781934,0.561044524059805,0.693259668319094,0.656629190079801,0.488161518470118,0.206954089515149,-0.129682565186927,-0.469499233162865,-0.76863410414412,-0.938087209937679,-0.995948332567428,-0.882079302389363,-0.672523619633425,-0.344117449707019,-0.00255971676030641,0.325787186887752,0.569982309456731,0.679630280083489,0.651997294382501,0.495115906749856,0.203639627158186,-0.132973922351087,-0.4719216466198,-0.756250129686196,-0.93824180887805,-0.978106577051792,-0.889857383854356,-0.659181900628746,-0.34530319821814,0.00444947142880947,0.318208686946728,0.559097288777421,0.674736441067946,0.65597143204616,0.501688616259935,0.208897910146767,-0.120880508330239,-0.468488260493223,-0.753998095455966,-0.941408998407532,-0.983515197721931,-0.89649248337618,-0.662433727329181,-0.356006174800848,-0.00301470148646322,0.316768021433432,0.560263413876254,0.674233849159237,0.655497055904593,0.490109519995781,0.208349116983365,-0.12378102107353,-0.461189051959011,-0.747741466666318,-0.93699785659331,-0.980876735778848,-0.872727687051187,-0.6609355904496,-0.361425993603725,-0.00631296400297691,0.316401231464663,0.564934800843818,0.676949967579587,0.661416561069154,0.498378007843474,0.209298860579755,-0.136321038662627,-0.465830649530659,-0.749750232187067,-0.942318552645917,-0.988706292654514,-0.899434842368425,-0.672980385756277,-0.35458773134813,-0.00314887871262582,0.314482216184578,0.554679388582506,0.6885722715086,0.655833008450571,0.500853582017998,0.221644372387754,-0.114491392997028,-0.458782318725707,-0.749388190003664,-0.937842457959917,-0.985140604017239,-0.886383257036073,-0.664058582126625,-0.353945902913829,-0.0115490680735167,0.305731737857921,0.56891214546558,0.676738537052776,0.662039722093119,0.499981029091762,0.22534843709447,-0.108909285906527,-0.449383445474037,-0.747506138246052,-0.940419930571925,-0.988028037599301,-0.894900109882844,-0.671455549657394,-0.357641080101239,-0.0105278795521511,0.324428341310937,0.561042140226194,0.683878459741974,0.6500171907197,0.489513167487283,0.224431031103335,-0.115570495392791,-0.462667250155762,-0.750848304939456,-0.937398001523809,-0.985835537867056,-0.893509902845207,-0.674307214164096,-0.357758313751521,-0.00902530771770126,0.307752494325416,0.575828232731941,0.673935937458383,0.668447207787988,0.490132089128447,0.22085885648356,-0.114761407800212,-0.463965251072998,-0.732734541063018,-0.933105308989014,-0.986117557230056,-0.900501469126772,-0.681333232143409,-0.364251220802212,-0.0110037955339016,0.310327627119161,0.566979277707201,0.678615700481064,0.657996507568505,0.504088157326812,0.237109354247146,-0.116072886119704,-0.451121293704367,-0.74274597588158,-0.930448621425573,-0.988215977499951,-0.893851362608485,-0.665790800297019,-0.375837659868972,-0.0172301053631034,0.312048341256843,0.561475876220202,0.666594174062212,0.666924579188023,0.502739450475303,0.219698916159452,-0.111849744799598,-0.450887531369719,-0.74385420086674,-0.921438911185153,-0.991589166617866,-0.888036039322579,-0.679419538422745,-0.359175591486341,-0.0138706189616079,0.306480456866589,0.555961090560412,0.675296671109406,0.657366222413135,0.492603625417702,0.226650714436906,-0.11843602016161,-0.457709452941961,-0.747989377295317,-0.934001470365113,-0.979713915650459,-0.898282676982372,-0.676705109685538,-0.366656259162133,-0.00663349587525806,0.311612712066918,0.554723738805798,0.67652857818938,0.654746644589484,0.504112320592568,0.226634226110231,-0.108254197422972,-0.447450426307059,-0.740921894181597,-0.926539593948898,-0.989835672534188,-0.896492739515649,-0.67360132540961,-0.36303114656087,-0.0143806026945031,0.312298907988051,0.560809227555944,0.691376043270478,0.660704941972175,0.500189663122382,0.239111219517086,-0.108018747689834,-0.458812450022332,-0.747192819625391,-0.930780705533348,-0.985845041403132,-0.887165799947759,-0.672158699781756,-0.367739993622095,-0.0024106938760742,0.309762857794326,0.562499555309541,0.68000419927232,0.659775116698051,0.500542292908651,0.236635249380673,-0.10682999329593,-0.460577962367832,-0.746539770818691,-0.931801126683411,-0.97611662118654,-0.896340821251616,-0.680925610215721,-0.357812095829117,-0.00722377429903758,0.313475472626357,0.553702408649276,0.683798275774044,0.66518546325598,0.504359423373969,0.225636526262308,-0.106730706522032,-0.450471153774067,-0.74141533475995,-0.927623113772328,-0.986795927256534,-0.892815716695075,-0.669551742548523,-0.37086334902362,-0.0159075521013869,0.30960681007672,0.563069305521227,0.688464571564225,0.656303216976966,0.49991934043293,0.230061375113608,-0.105878461963116,-0.447489121140879,-0.741334316455013,-0.932777871760083,-0.993576876846684,-0.898516535482343,-0.673894272634654,-0.362031045710996,-0.00771715528320456,0.306274502962093,0.575534446792093,0.679010465592125,0.655761088907384,0.495753925375303,0.227696443157469,-0.126905265275733,-0.454553601650654,-0.748124449127006,-0.931875768324014,-0.98848784532727,-0.893808466065173,-0.674047236700709,-0.364116518193148,-0.0100263594604082,0.314593024494643,0.556202958579761,0.691305843380281,0.666082825289112,0.491685285020699,0.223683298782407,-0.108572914259854,-0.450088653862298,-0.748651409557294,-0.925728176087613,-0.979121678585523,-0.887892488612955,-0.676887239508826,-0.352099241099117,-0.00412135452666365,0.312834665578152,0.549454548850441,0.687588307999582,0.660017295484252,0.503843782912779,0.217889352593295,-0.111691908354079,-0.461224812854047,-0.753446550343613,-0.936122853043905,-0.995479512860912,-0.885018331282696,-0.672497837958931,-0.349740849606371,-0.00412817341245443,0.311969138463931,0.55930227209415,0.677480288373564,0.651822072475615,0.492546167321457,0.221527750426079,-0.107066991488429,-0.462066202313666,-0.75378397898709,-0.939634409564977,-0.979347697290829,-0.882311113467762,-0.664362585492977,-0.356106998851461,-0.00453445886616435,0.310710734022573,0.561482008709316,0.670669170484902,0.651680065911135,0.491549650227886,0.21248082140265,-0.116782548047353,-0.461148723908131,-0.752395531224275,-0.932247169076359,-0.989550467771715,-0.888120082128498,-0.67395741609079,-0.368134293906583,0.00153925860048809,0.315265615225941,0.56107794514267,0.68430460063137,0.663969942365657,0.488504929483835,0.219716775738015,-0.119720296784573,-0.473099174236501,-0.751349571499405,-0.943878215778543,-0.983228620603005,-0.885994770300205,-0.662131024077342,-0.349008997114892,0.0038135036534646,0.314997791286051,0.562430897447234,0.668085314026955,0.655890389521952,0.495299012561099,0.215005680581109,-0.122633702544523,-0.46869111731566,-0.749048307230628,-0.930401248777805,-1.00232207814292,-0.889440789664895,-0.668715212542442,-0.340853793513022,-0.00257532255841127,0.323453568084756,0.561775096351902,0.68942628325202,0.667053855324684,0.497680844569942,0.212807998368976,-0.127287083603508,-0.469972524930094,-0.744033633335852,-0.94110211155245,-0.99184017561168,-0.886907461495041,-0.659395596800366,-0.337931992514182,-0.00117354610071382,0.317139015552134,0.565221176755092,0.684015074481992,0.65656403341374,0.493782386742915,0.208711678319717,-0.132534509568738,-0.477886183786712,-0.75950603672143,-0.945153749324552,-0.987950178267878,-0.875239690557436,-0.660962027933838,-0.339695099793994,0.00866831322120067,0.330534543285492,0.559613706722631,0.684058145994677,0.641589921340027,0.477534434271556,0.204097760957067,-0.141220300837842,-0.482148034533278,-0.763017686615601,-0.942821913299022,-0.982387283581394,-0.880253824376031,-0.640196848556594,-0.33835045643205,-0.008878658365942,0.344165615720392,0.555711968376966,0.676978616021889,0.644094693089408,0.488297732793856,0.206821506496963,-0.149234378915077,-0.467283534310556,-0.767275398918948,-0.945038341441803,-0.965869938594415,-0.880886995440981,-0.652565741783856,-0.329857559592415,0.0165983664073724,0.335645790529031,0.566685651328684,0.681311307416443,0.651048278409142,0.480519889094927,0.195917582361363,-0.146971008463465,-0.494161346022504,-0.767766028775204,-0.946186193199987,-0.988217398121338,-0.881213757920724,-0.641922402895589,-0.328329435281464,0.0260466598953503,0.339095005231891,0.580352743783833,0.678946617523525,0.652638722504933,0.482606783194418,0.201328207669328,-0.158898655460267,-0.492893424788039,-0.770108762114743,-0.944008172962992,-0.989702636869843,-0.87962311275589,-0.646064189301043,-0.32425837222633,0.0226837142819826,0.335729244122246,0.577076617577693,0.687260231430648,0.647645923112528,0.475795227298477,0.184872071840028,-0.153030799131624,-0.494093859888336,-0.772091291260373,-0.9498890980254,-0.975030639289616,-0.869000320852584,-0.649733610583023,-0.320845754681054,0.034423321759887,0.349014847235935,0.573060684577288,0.670803050596699,0.653996307503633,0.469758229392968,0.187947192040079,-0.157700517945409,-0.493325371771709,-0.766394140358136,-0.950569834204675,-0.971515206737519,-0.869029206055986,-0.640223865396953,-0.31383493652365,0.027836346302563,0.347783985285488,0.582972228925794,0.672944078964187};

#define N 9

void inverter_matriz(float matriz[N][N], float inversa[N][N])
{
    // Inicializando a matriz identidade na matriz inversa
    for (int i = 0; i < N; i++) {
        for (int j = 0; j < N; j++) {
            if (i == j) {
                inversa[i][j] = 1;
            } else {
                inversa[i][j] = 0;
            }
        }
    }

    // Aplicando o mÃ©todo de Gauss-Jordan
    for (int i = 0; i < N; i++)
    {
        float pivot = matriz[i][i];
        for (int j = 0; j < N; j++)
        {
            matriz[i][j] /= pivot;
            inversa[i][j] /= pivot;
        }

        for (int k = 0; k < N; k++)
        {
            if (k != i)
            {
                float fator = matriz[k][i];
                for (int j = 0; j < N; j++)
                {
                    matriz[k][j] -= fator * matriz[i][j];
                    inversa[k][j] -= fator * inversa[i][j];
                }
            }
        }
    }
}

void salva(float A[N])
{
    FILE *file = fopen("/mnt/c/Users/labt5/OneDrive/Desktop/Cesar/IC_2024_Cesar/Dados/Calib_param_NLLS_c.csv", "w");
    for(int i=0; i < N; i++)
    {
        fprintf(file, "%.15f,", A[i]);
        fprintf(file, "\n");
    }
}

int main()
{
    int tam1 = sizeof(mx)/sizeof(int);
    #define tam tam1


    int passo = 0, loop = 1;
    float sf = 1;
    float p0[9] = {1, 1, 1, 0, 0, 0, 0, 0, 0}, Be[tam], e[tam], f[tam], sx, sy, sz, bx, by, bz, rho, phi, lambida, error_ant, J, delta_J, mat_H[N][tam];
    float sin_phi, sin_rho, sin_lambda, cos_phi, cos_rho, cos_lambda;
    float Ht_H[N][N], Ht_e[N], inv[N][N], mul_mat[N][tam];

    for (int i=0; i < tam; i++)
    {
        Be[i] = 1*sf;
    }

    while(loop == 1)
    {
        sx = p0[0];
        sy = p0[1];
        sz = p0[2];
        bx = p0[3];
        by = p0[4];
        bz = p0[5];
        rho = p0[6];
        phi = p0[7];
        lambida = p0[8];

        sin_phi = sinf(phi);
        sin_rho = sinf(rho);
        sin_lambda = sinf(lambida);
        cos_phi = cosf(phi);
        cos_rho = cosf(rho);
        cos_lambda = cosf(lambida);
        
        for(int i=0; i < tam; i++)
        {
            f[i] = ((mx[i]-bx)*(mx[i]-bx))/(sx*sx) + ((sx*(my[i]-by) - sy*sin_rho*(mx[i]-bx))*((sx*(my[i]-by) - sy*sin_rho*(mx[i]-bx))))/((sx*sy*cos_rho)*(sx*sy*cos_rho)) + ((sx*sy*cos_rho*(mz[i]-bz) - sx*sz*sin_lambda*(my[i]-by) + sy*sz*(sin_lambda*sin_rho - cos_rho*sin_phi*cos_lambda)*(mx[i]-bx))*(sx*sy*cos_rho*(mz[i]-bz) - sx*sz*sin_lambda*(my[i]-by) + sy*sz*(sin_lambda*sin_rho - cos_rho*sin_phi*cos_lambda)*(mx[i]-bx)))/((sx*sy*sz*cos_rho*cos_phi*cos_lambda)*(sx*sy*sz*cos_rho*cos_phi*cos_lambda));

            e[i] = (Be[i] * Be[i]) - f[i];

            mat_H[0][i] = (2*(sx*(by - my[i]) - sy*sin_rho*(bx - mx[i]))*(by - my[i]))/(sx*sx*sy*sy*cos_rho*cos_rho) - (2*((sx*(by - my[i]) - sy*sin_rho*(bx - mx[i]))*(sx*(by - my[i]) - sy*sin_rho*(bx - mx[i]))))/((sx*sx*sx)*sy*sy*cos_rho*cos_rho) - (2*((bx - mx[i])*(bx - mx[i])))/(sx*sx*sx) - (2*((sy*sz*(sin_lambda*sin_rho - cos_lambda*cos_rho*sin_phi)*(bx - mx[i]) + sx*sy*cos_rho*(bz - mz[i]) - sx*sz*sin_lambda*(by - my[i])) * (sy*sz*(sin_lambda*sin_rho - cos_lambda*cos_rho*sin_phi)*(bx - mx[i]) + sx*sy*cos_rho*(bz - mz[i]) - sx*sz*sin_lambda*(by - my[i]))))/((sx*sx*sx)*sy*sy*sz*sz*cos_lambda*cos_lambda*cos_phi*cos_phi*cos_rho*cos_rho) + (2*(sy*cos_rho*(bz - mz[i]) - sz*sin_lambda*(by - my[i]))*(sy*sz*(sin_lambda*sin_rho - cos_lambda*cos_rho*sin_phi)*(bx - mx[i]) + sx*sy*cos_rho*(bz - mz[i]) - sx*sz*sin_lambda*(by - my[i])))/(sx*sx*sy*sy*sz*sz*cos_lambda*cos_lambda*cos_phi*cos_phi*cos_rho*cos_rho);

            mat_H[1][i] = -(2*(by - my[i])*(by*sx*sz*sin_lambda*sin_lambda - my[i]*sx*sz*sin_lambda*sin_lambda + by*sx*sz*cos_lambda*cos_lambda*cos_phi*cos_phi - my[i]*sx*sz*cos_lambda*cos_lambda*cos_phi*cos_phi - bz*sx*sy*cos_rho*sin_lambda + mz[i]*sx*sy*cos_rho*sin_lambda - bx*sy*sz*sin_lambda*sin_lambda*sin_rho + mx[i]*sy*sz*sin_lambda*sin_lambda*sin_rho - bx*sy*sz*cos_lambda*cos_lambda*cos_phi*cos_phi*sin_rho + mx[i]*sy*sz*cos_lambda*cos_lambda*cos_phi*cos_phi*sin_rho + bx*sy*sz*cos_lambda*cos_rho*sin_lambda*sin_phi - mx[i]*sy*sz*cos_lambda*cos_rho*sin_lambda*sin_phi))/(sx*(sy*sy*sy)*sz*cos_lambda*cos_lambda*cos_phi*cos_phi*cos_rho*cos_rho);

            mat_H[2][i] = -(2*(bz - mz[i])*(bz*sx*sy*cos_rho - by*sx*sz*sin_lambda - mz[i]*sx*sy*cos_rho + my[i]*sx*sz*sin_lambda + bx*sy*sz*sin_lambda*sin_rho - mx[i]*sy*sz*sin_lambda*sin_rho - bx*sy*sz*cos_lambda*cos_rho*sin_phi + mx[i]*sy*sz*cos_lambda*cos_rho*sin_phi))/(sx*sy*(sz*sz*sz)*cos_lambda*cos_lambda*cos_phi*cos_phi*cos_rho);

            mat_H[3][i] = (2*bx - 2*mx[i])/sx*sx - (2*sin_rho*(sx*(by - my[i]) - sy*sin_rho*(bx - mx[i])))/(sx*sx*sy*cos_rho*cos_rho) + (2*(sin_lambda*sin_rho - cos_lambda*cos_rho*sin_phi)*(sy*sz*(sin_lambda*sin_rho - cos_lambda*cos_rho*sin_phi)*(bx - mx[i]) + sx*sy*cos_rho*(bz - mz[i]) - sx*sz*sin_lambda*(by - my[i])))/(sx*sx*sy*sz*cos_lambda*cos_lambda*2*cos_phi*cos_phi*cos_rho*cos_rho);

            mat_H[4][i] = (2*(sx*(by - my[i]) - sy*sin_rho*(bx - mx[i])))/(sx*sy*sy*cos_rho*cos_rho) - (2*sin_lambda*(sy*sz*(sin_lambda*sin_rho - cos_lambda*cos_rho*sin_phi)*(bx - mx[i]) + sx*sy*cos_rho*(bz - mz[i]) - sx*sz*sin_lambda*(by - my[i])))/(sx*sy*sy*sz*cos_lambda*cos_lambda*cos_phi*cos_phi*cos_rho*cos_rho);

            mat_H[5][i] = (2*(sy*sz*(sin_lambda*sin_rho - cos_lambda*cos_rho*sin_phi)*(bx - mx[i]) + sx*sy*cos_rho*(bz - mz[i]) - sx*sz*sin_lambda*(by - my[i])))/(sx*sy*sz*sz*cos_lambda*cos_lambda*cos_phi*cos_phi*cos_rho);

            mat_H[6][i] = -(2*(bx*sy - mx[i]*sy - by*sx*sin_rho + my[i]*sx*sin_rho)*(by*sx*sz*sin_lambda*sin_lambda - my[i]*sx*sz*sin_lambda*sin_lambda + by*sx*sz*cos_lambda*cos_lambda*cos_phi*cos_phi - my[i]*sx*sz*cos_lambda*cos_lambda*cos_phi*cos_phi - bz*sx*sy*cos_rho*sin_lambda + mz[i]*sx*sy*cos_rho*sin_lambda - bx*sy*sz*sin_lambda*sin_lambda*sin_rho + mx[i]*sy*sz*sin_lambda*sin_lambda*sin_rho - bx*sy*sz*cos_lambda*cos_lambda*cos_phi*cos_phi*sin_rho + mx[i]*sy*sz*cos_lambda*cos_lambda*cos_phi*cos_phi*sin_rho + bx*sy*sz*cos_lambda*cos_rho*sin_lambda*sin_phi - mx[i]*sy*sz*cos_lambda*cos_rho*sin_lambda*sin_phi))/(sx*sx*sy*sy*sz*cos_lambda*cos_lambda*cos_phi*cos_phi*(cos_rho*cos_rho*cos_rho));

            mat_H[7][i] = (2*sin_phi*((sy*sz*(sin_lambda*sin_rho - cos_lambda*cos_rho*sin_phi)*(bx - mx[i]) + sx*sy*cos_rho*(bz - mz[i]) - sx*sz*sin_lambda*(by - my[i]))*(sy*sz*(sin_lambda*sin_rho - cos_lambda*cos_rho*sin_phi)*(bx - mx[i]) + sx*sy*cos_rho*(bz - mz[i]) - sx*sz*sin_lambda*(by - my[i]))))/(sx*sx*sy*sy*sz*sz*cos_lambda*cos_lambda*(cos_phi*cos_phi*cos_phi)*cos_rho*cos_rho) - (2*(bx - mx[i])*(sy*sz*(sin_lambda*sin_rho - cos_lambda*cos_rho*sin_phi)*(bx - mx[i]) + sx*sy*cos_rho*(bz - mz[i]) - sx*sz*sin_lambda*(by - my[i])))/(sx*sx*sy*sz*cos_lambda*cos_phi*cos_rho);

            mat_H[8][i] = (2*sin_lambda*((sy*sz*(sin_lambda*sin_rho - cos_lambda*cos_rho*sin_phi)*(bx - mx[i]) + sx*sy*cos_rho*(bz - mz[i]) - sx*sz*sin_lambda*(by - my[i]))*(sy*sz*(sin_lambda*sin_rho - cos_lambda*cos_rho*sin_phi)*(bx - mx[i]) + sx*sy*cos_rho*(bz - mz[i]) - sx*sz*sin_lambda*(by - my[i]))))/(sx*sx*sy*sy*sz*sz*(cos_lambda*cos_lambda*cos_lambda)*cos_phi*cos_phi*(cos_rho*cos_rho)) + (2*(sy*sz*(cos_lambda*sin_rho + cos_rho*sin_lambda*sin_phi)*(bx - mx[i]) - sx*sz*cos_lambda*(by - my[i]))*(sy*sz*(sin_lambda*sin_rho - cos_lambda*cos_rho*sin_phi)*(bx - mx[i]) + sx*sy*cos_rho*(bz - mz[i]) - sx*sz*sin_lambda*(by - my[i])))/(sx*sx*sy*sy*sz*sz*cos_lambda*cos_lambda*cos_phi*cos_phi*cos_rho*cos_rho);
        }
        
        J = 0;

        for(int i=0; i < tam; i++)
        {
            J += (e[i] * e[i])/2;
        }

        if(passo < 2)
        {
            error_ant = J;
        }
        else
        {
            delta_J = 100*fabs(J-error_ant)/J;
            if(delta_J < 0.05)
            {
                loop = 0;
            }
            error_ant = J;
        }

        for(int i = 0; i < N; i++)
        {
            for(int j = 0; j < N; j++)
            {
                Ht_H[i][j] = 0;
                for(int k = 0; k < tam; k++)
                {
                    Ht_H[i][j] += mat_H[i][k]*mat_H[j][k];
                }
            }
        }

        inverter_matriz(Ht_H, inv);

        for(int i = 0; i < N; i++)
        {
            for(int j = 0; j < tam; j++)
            {
                mul_mat[i][j] = 0;
                for(int k = 0; k < N; k++)
                {
                    mul_mat[i][j] += inv[i][k]*mat_H[k][j];
                }
            }
        }

        for(int i = 0; i < N; i++)
        {
            Ht_e[i] = 0;
            for(int j = 0; j < tam; j++)
            {
                Ht_e[i] += mul_mat[i][j]*e[j];
            }
        }

        for(int i = 0; i < N; i++)
        {
            p0[i] += Ht_e[i];
        }
        
        passo++;
    }

    salva(p0);

    printf("The estimated parameters:\n\n");
    printf("The scale factors:\n");
    printf("%.4f\n", p0[0]);
    printf("%.4f\n", p0[1]);
    printf("%.4f\n", p0[2]);
    printf("\nThe offsets:\n");
    printf("%.4f\n", p0[3]);
    printf("%.4f\n", p0[4]);
    printf("%.4f\n", p0[5]);
    printf("\nThe angles:\n");
    printf("%.4f\n", p0[6]);
    printf("%.4f\n", p0[7]);
    printf("%.4f\n", p0[8]);

    return 0;
}